<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Asteroid Collision - Solution</title>
</head>
<body>
<h2 id="solution">Asteroid Collision - Solution</h2>
<h4 id="approach-stack">Approach: Stack</h4>
<p><strong>Intuition</strong></p>
<p>We have <span class="math math-inline"><span class="katex"><span class="katex-mathml">NN</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 0.6833em;"></span><span
        class="mord mathnormal" style="margin-right: 0.10903em;">N</span></span></span></span></span> asteroids, each
    represented by an integer. The absolute value represents the size, and the sign (positive or negative) of the
    integer represents the direction the asteroid is moving; all stones are moving at the same speed. These asteroids
    can collide, and if they do, the smaller one explodes and vanishes. If both asteroids are of the same size, then
    both will explode. We need to return the final state of asteroids after all collisions.</p>
<p>The first important thing to find out is when two asteroids will collide. Two stones moving in the same direction can
    never collide. Hence it's tempting to assume that whenever two asteroids are moving in opposite directions, they
    will collide. However, consider the below image; the red stone is moving in the left direction, and the blue stone
    is moving in the right direction. It is clear from the picture these two asteroids will never collide.</p>
<p><img src="735A.png" alt="fig"></p>
<p>On the other hand, if the red stone is moving towards the right and the blue stone is moving towards the left, they
    will collide, as shown below. Therefore, the only case when the asteroids will collide is when the asteroid on the
    left-hand side is moving towards the right, and the asteroid on the right side is moving towards the left.</p>
<p><img src="735B.png" alt="fig"></p>
<p>Now, if we iterate over asteroids from left to right, then each asteroid moving left will collide with asteroids that
    came before it that are moving right. If the current stone is smaller than the one we saw earlier, it will explode,
    and the collision chain will stop there. On the other hand, if it's bigger, it will keep moving toward the left and
    might collide further with other asteroids we saw earlier that are moving toward the right. Hence, the observation
    here is that each stone might keep colliding with asteroids on its left until it collides with a bigger asteroid and
    explodes. This requirement could be fulfilled by the stack data structure; if we keep asteroids in the stack, then
    for each asteroid, the collision chain can be executed by checking the top of the stack and popping if an asteroid
    should be destroyed.</p>
<p>The below slideshow demonstrates how directions and size are used to detect all collisions.</p>
<p>
<div class="relative mx-auto mb-6 flex flex-col overflow-hidden rounded-lg border-[1px] border-label-1"
     style="max-width: 960px;">
    <div class="rounded-lg" style="max-height: 720px;"><img alt="Current"
                                                            class="object-fit-contain !mb-0 max-h-full max-w-full"
                                                            src="blob:https://leetcode.com/53273724-a136-443b-b380-8f107c89605f">
    </div>
    <div class="absolute top-[50%] left-[50%] flex h-12 w-12 translate-x-[-50%] translate-y-[-50%] items-center justify-center rounded-full bg-black/30">
        <div class="flex h-4 w-4 cursor-pointer items-center justify-center text-[35px]">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor"
                 class="h-full w-full text-white">
                <path fill-rule="evenodd"
                      d="M18.97 12.871l-12.96 7.29a1 1 0 01-1.49-.87V4.71a1 1 0 011.49-.872l12.96 7.29a1 1 0 010 1.743z"
                      clip-rule="evenodd"></path>
            </svg>
        </div>
    </div>
    <div class="relative flex h-8 select-none items-center justify-around bg-black">
        <div class="flex items-center space-x-7">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor"
                 class="w-4 cursor-pointer text-gray-6 dark:text-dark-gray-6 hover:text-gray-7 dark:hover:text-dark-gray-7">
                <path fill-rule="evenodd"
                      d="M16.091 4.929l-7.057 7.078 7.057 7.064a1 1 0 01-1.414 1.414l-7.764-7.77a1 1 0 010-1.415l7.764-7.785a1 1 0 111.415 1.414z"
                      clip-rule="evenodd"></path>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor"
                 class="w-4 cursor-pointer text-gray-6 dark:text-dark-gray-6 hover:text-gray-7 dark:hover:text-dark-gray-7">
                <path fill-rule="evenodd"
                      d="M18.97 12.871l-12.96 7.29a1 1 0 01-1.49-.87V4.71a1 1 0 011.49-.872l12.96 7.29a1 1 0 010 1.743z"
                      clip-rule="evenodd"></path>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor"
                 class="w-4 cursor-pointer text-gray-6 dark:text-dark-gray-6 hover:text-gray-7 dark:hover:text-dark-gray-7">
                <path fill-rule="evenodd"
                      d="M7.913 19.071l7.057-7.078-7.057-7.064a1 1 0 011.414-1.414l7.764 7.77a1 1 0 010 1.415l-7.764 7.785a1 1 0 01-1.414-1.414z"
                      clip-rule="evenodd"></path>
            </svg>
        </div>
        <div class="absolute right-0 mr-5 text-xs font-medium text-white">1 / 3</div>
    </div>
</div>
</p>
<p><strong>Algorithm</strong></p>
<ol>
    <li>
        <p>Iterate over the asteroids from left to right; for each <code>asteroid</code> do the following:</p>
        <p>i. Initialize a boolean <code>flag</code> to <code>true</code>. We will use this flag later to determine if
            we should store this asteroid in the stack or if it will explode.</p>
        <p>ii. If there is an asteroid in the stack and the asteroid on the top of the stack can collide with this
            asteroid, then we have some options here.</p>
        <div class="mb-6 rounded-lg px-3 py-2.5 font-menlo text-sm bg-fill-3 dark:bg-dark-fill-3">
            <div class="group relative" translate="no"><pre
                    style="color: rgb(212, 212, 212); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 0px; margin: 0px; overflow: auto; background: transparent;"><code
                    class="language-swift"
                    style="color: rgb(212, 212, 212); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span> a</span><span
                    class="token" style="color: rgb(212, 212, 212);">.</span><span> </span><span class="token"
                                                                                                 style="color: rgb(78, 201, 176);">If</span><span> the `asteroid` </span><span
                    class="token"
                    style="color: rgb(86, 156, 214);">is</span><span> bigger than the asteroid on the top</span><span
                    class="token" style="color: rgb(212, 212, 212);">,</span><span> then this asteroid on the top will explode</span><span
                    class="token"
                    style="color: rgb(212, 212, 212);">,</span><span> and we will pop it from the stack</span><span
                    class="token" style="color: rgb(212, 212, 212);">.</span><span>
</span></span><span><span> b</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span> </span><span
                    class="token"
                    style="color: rgb(78, 201, 176);">If</span><span> the `asteroid` has the same size </span><span
                    class="token" style="color: rgb(86, 156, 214);">as</span><span> the asteroid on the top</span><span
                    class="token" style="color: rgb(212, 212, 212);">,</span><span> then both will explode</span><span
                    class="token" style="color: rgb(212, 212, 212);">.</span><span> </span><span class="token"
                                                                                                 style="color: rgb(78, 201, 176);">Hence</span><span> we will pop it from the stack</span><span
                    class="token" style="color: rgb(212, 212, 212);">;</span><span> also</span><span class="token"
                                                                                                     style="color: rgb(212, 212, 212);">,</span><span> we will mark `flag` </span><span
                    class="token" style="color: rgb(86, 156, 214);">as</span><span> `</span><span class="token"
                                                                                                  style="color: rgb(86, 156, 214);">false</span><span>` because this `asteroid` will also explode</span><span
                    class="token" style="color: rgb(212, 212, 212);">,</span><span> and hence we won't save it into the stack</span><span
                    class="token" style="color: rgb(212, 212, 212);">.</span><span>
</span></span><span><span> c</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span> </span><span
                    class="token" style="color: rgb(78, 201, 176);">If</span><span> the `asteroid` </span><span
                    class="token"
                    style="color: rgb(86, 156, 214);">is</span><span> smaller than the asteroid on the top</span><span
                    class="token" style="color: rgb(212, 212, 212);">,</span><span> then the asteroid on the top will not explode</span><span
                    class="token" style="color: rgb(212, 212, 212);">,</span><span> so we will not pop it</span><span
                    class="token" style="color: rgb(212, 212, 212);">.</span><span> </span><span class="token"
                                                                                                 style="color: rgb(78, 201, 176);">But</span><span> the `asteroid` will explode and thus we will mark `flag` </span><span
                    class="token" style="color: rgb(86, 156, 214);">as</span><span> `</span><span class="token"
                                                                                                  style="color: rgb(86, 156, 214);">false</span><span>`</span><span
                    class="token" style="color: rgb(212, 212, 212);">.</span></span></code></pre>
                <div class="h-4 w-4 cursor-pointer absolute top-0 right-0">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em"
                         fill="currentColor"
                         class="h-4 w-4 fill-gray-6 hover:fill-gray-7 dark:fill-dark-gray-6 dark:hover:fill-dark-gray-7 hidden group-hover:block">
                        <path fill-rule="evenodd"
                              d="M11.3 8.3H19a3 3 0 013 3V19a3 3 0 01-3 3h-7.7a3 3 0 01-3-3v-7.7a3 3 0 013-3zm0 2a1 1 0 00-1 1V19a1 1 0 001 1H19a1 1 0 001-1v-7.7a1 1 0 00-1-1h-7.7zm-5.6 3.4a1 1 0 110 2h-.9A2.8 2.8 0 012 12.9V4.8A2.8 2.8 0 014.8 2h8.1a2.8 2.8 0 012.8 2.8v.9a1 1 0 11-2 0v-.9a.8.8 0 00-.8-.8H4.8a.8.8 0 00-.8.8v8.1a.8.8 0 00.8.8h.9z"
                              clip-rule="evenodd"></path>
                    </svg>
                </div>
            </div>
        </div>
        <p>iii. If <code>flag</code> is <code>true</code>, add the <code>asteroid</code> to the stack.</p>
    </li>
    <li>
        <p>Add the asteroids from the stack into the list <code>remainingAsteroids</code> in the reverse order.</p>
    </li>
    <li>
        <p>Return <code>remainingAsteroids</code>.</p>
    </li>
</ol>
<p><strong>Implementation</strong></p>
<pre>
    Java
    <code>
        class Solution {
    public int[] asteroidCollision(int[] asteroids) {
        Stack<Integer> st = new Stack<Integer>();

        for (int asteroid : asteroids) {
            boolean flag = true;
            while (!st.isEmpty() && (st.peek() > 0 && asteroid < 0)) {
                // If the top asteroid in the stack is smaller, then it will explode.
                // Hence pop it from the stack, also continue with the next asteroid in the stack.
                if (Math.abs(st.peek()) < Math.abs(asteroid)) {
                    st.pop();
                    continue;
                }
                // If both asteroids have the same size, then both asteroids will explode.
                // Pop the asteroid from the stack; also, we won't push the current asteroid to the stack.
                else if (Math.abs(st.peek()) == Math.abs(asteroid)) {
                    st.pop();
                }

                // If we reach here, the current asteroid will be destroyed
                // Hence, we should not add it to the stack
                flag = false;
                break;
            }

            if (flag) {
                st.push(asteroid);
            }
        }

        // Add the asteroids from the stack to the vector in the reverse order.
        int[] remainingAsteroids = new int[st.size()];
        for (int i = remainingAsteroids.length - 1; i >= 0; i--) {
            remainingAsteroids[i] = st.peek();
            st.pop();
        }

        return remainingAsteroids;
    }
}
    </code>
    C++
    <code>
        class Solution {
public:
    vector<int> asteroidCollision(vector<int>& asteroids) {
        stack<int> st;

        for (int asteroid : asteroids) {
            int flag = 1;
            while (!st.empty() && (st.top() > 0 && asteroid < 0)) {
                // If the top asteroid in the stack is smaller, then it will explode.
                // Hence pop it from the stack, also continue with the next asteroid in the stack.
                if (abs(st.top()) < abs(asteroid)) {
                    st.pop();
                    continue;
                }
                // If both asteroids are the same size, then both asteroids will explode.
                // Pop the asteroid from the stack; also, we won't push the current asteroid to the stack.
                else if (abs(st.top()) == abs(asteroid)) {
                    st.pop();
                }

                // If we reach here, the current asteroid will be destroyed
                // Hence, we should not add it to the stack
                flag = 0;
                break;
            }

            if (flag) {
                st.push(asteroid);
            }
        }

        // Add the asteroids from the stack to the vector in the reverse order.
        vector<int> remainingAsteroids (st.size());
        for (int i = remainingAsteroids.size() - 1; i >= 0; i--){
            remainingAsteroids[i] = st.top();
            st.pop();
        }

        return remainingAsteroids;
    }
};
    </code>
</pre>
<p><strong>Complexity Analysis</strong></p>
<p>Here, <span class="math math-inline"><span class="katex"><span class="katex-mathml">NN</span><span class="katex-html"
                                                                                                      aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                style="margin-right: 0.10903em;">N</span></span></span></span></span>
    is the number of asteroids in the list.</p>
<ul>
    <li>
        <p>Time complexity: <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">O(N)O(N)</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal"
                                                                                         style="margin-right: 0.02778em;">O</span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span
                class="mclose">)</span></span></span></span></span>.</p>
        <p>We iterate over each asteroid in the list, and for each asteroid, we might iterate over the asteroids we have
            in the stack and keep popping until they explode. The important point is that each asteroid can be added and
            removed from the stack only once. Therefore, each asteroid can be processed only twice, first when we
            iterate over it and then again while popping it from the stack. Therefore, the total time complexity is
            equal to <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(N)O(N)</span><span
                    class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                   style="height: 1em; vertical-align: -0.25em;"></span><span
                    class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span
                    class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span
                    class="mclose">)</span></span></span></span></span>.</p>
    </li>
    <li>
        <p>Space complexity: <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">O(N)O(N)</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal"
                                                                                         style="margin-right: 0.02778em;">O</span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span
                class="mclose">)</span></span></span></span></span>.</p>
        <p>The only space required is for the stack; the maximum number of asteroids that could be there in the stack is
            <span class="math math-inline"><span class="katex"><span class="katex-mathml">NN</span><span
                    class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                   style="height: 0.6833em;"></span><span
                    class="mord mathnormal" style="margin-right: 0.10903em;">N</span></span></span></span></span> when
            there is no asteroid collision. The final list that we return, <code>remainingAsteroids</code>, is used to
            store the output, which is generally not considered part of space complexity. Hence, the total space
            complexity equals <span class="math math-inline"><span class="katex"><span
                    class="katex-mathml">O(N)O(N)</span><span class="katex-html" aria-hidden="true"><span
                    class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                    class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span
                    class="mord mathnormal" style="margin-right: 0.10903em;">N</span><span
                    class="mclose">)</span></span></span></span></span>.<br>
            <br></p>
    </li>
</ul>
<hr>
</body>
</html>