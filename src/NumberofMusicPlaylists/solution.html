<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Number of Music Playlists - Solution</title>
</head>
<body>
<h2 id="solution">Number of Music Playlists - Solution</h2>
<hr>
<h3 id="approach-1-bottom-up-dynamic-programming">Approach 1: Bottom-up Dynamic Programming</h3>
<blockquote>
    <p><strong>Note.</strong> For this approach, we assume that you already know the fundamentals of dynamic programming
        and are figuring out how to apply it to a wide range of problems, such as this one. If you are not yet at this
        stage, we recommend checking out our relevant <a
                href="https://leetcode.com/explore/featured/card/dynamic-programming/" target="_blank">Explore Card
            content on dynamic programming</a> before coming back to this approach.</p>
</blockquote>
<h4 id="intuition">Intuition</h4>
<p>We can't simply generate all possible playlists because the problem constraints are too large. Therefore, we need to
    approach this problem in a different, more efficient way. That's where dynamic programming comes in.</p>
<p>We're using a dynamic programming (DP) table <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span class="katex-html" aria-hidden="true"><span
        class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
        class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
        class="mclose">]</span></span></span></span></span> to represent the number of possible playlists of length
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6595em;"></span><span
            class="mord mathnormal">i</span></span></span></span></span> containing exactly <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">jj</span><span class="katex-html"
                                                                                                   aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> unique songs.
    Our goal is to calculate <span class="math math-inline"><span class="katex"><span class="katex-mathml">dp[goal][n]\text{dp}[\text{goal}][n]</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
            class="mord text"><span class="mord">goal</span></span><span class="mclose">]</span><span
            class="mopen">[</span><span class="mord mathnormal">n</span><span
            class="mclose">]</span></span></span></span></span>, which represents the number of ways we can make a
    playlist of length <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">goal\text{goal}</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span
            class="mord text"><span class="mord">goal</span></span></span></span></span></span> using exactly <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">nn</span><span class="katex-html"
                                                                                                   aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.4306em;"></span><span
            class="mord mathnormal">n</span></span></span></span></span> unique songs.</p>
<h5 id="base-cases">Base cases</h5>
<p>To generate the DP table, we need to define the initial conditions:</p>
<ul>
    <li><span class="math math-inline"><span class="katex"><span
            class="katex-mathml">dp[0][0]=1\text{dp}[0][0] = 1</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span class="mord">0</span><span
            class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span
            class="mclose">]</span><span class="mspace" style="margin-right: 0.2778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>.
        This represents that there's exactly one way to create a playlist of length <span class="math math-inline"><span
                class="katex"><span class="katex-mathml">00</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.6444em;"></span><span
                class="mord">0</span></span></span></span></span> with <span class="math math-inline"><span
                class="katex"><span class="katex-mathml">00</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.6444em;"></span><span
                class="mord">0</span></span></span></span></span> unique songs, which is essentially an empty playlist.
    </li>
    <li>For all <span class="math math-inline"><span class="katex"><span class="katex-mathml">i&lt;ji &lt; j</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6986em; vertical-align: -0.0391em;"></span><span
            class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2778em;"></span><span
            class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span
            class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span>, <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">dp[i][j]=0\text{dp}[i][j] = 0</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
            class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span><span
            class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace"
                                                                                                   style="margin-right: 0.2778em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span></span>.
        This makes sense because we can't form a playlist of length <span class="math math-inline"><span
                class="katex"><span class="katex-mathml">ii</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span>
        with <span class="math math-inline"><span class="katex"><span class="katex-mathml">jj</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> unique
        songs when <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">i&lt;ji &lt; j</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.6986em; vertical-align: -0.0391em;"></span><span
                class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2778em;"></span><span
                class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span
                class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span>. There
        just aren't enough slots in the playlist to accommodate all the unique songs.
    </li>
</ul>
<h5 id="transtions">Transtions</h5>
<p>Now, let's look at the transition rules to fill up the rest of the DP table. Let's say we want to compute the value
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
            class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span></span></span></span></span>.
</p>
<p>If we add a song that we haven't played yet to the playlist, the playlist length increases by <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">11</span><span class="katex-html"
                                                                                               aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">1</span></span></span></span></span> (from <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">i−1i - 1</span><span class="katex-html" aria-hidden="true"><span class="base"><span
        class="strut" style="height: 0.7429em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">i</span><span
        class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace"
                                                                                               style="margin-right: 0.2222em;"></span></span><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">1</span></span></span></span></span> to <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">ii</span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                                           style="height: 0.6595em;"></span><span
        class="mord mathnormal">i</span></span></span></span></span>), and the number of unique songs also increases by
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">11</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>
    (from <span class="math math-inline"><span class="katex"><span class="katex-mathml">j−1j - 1</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                   style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>
    to <span class="math math-inline"><span class="katex"><span class="katex-mathml">jj</span><span class="katex-html"
                                                                                                    aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span>). Therefore, a
    playlist of length <span class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6595em;"></span><span
            class="mord mathnormal">i</span></span></span></span></span> with <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">jj</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> unique songs
    can be formed by adding new songs to each playlist of length <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">i−1i - 1</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.7429em; vertical-align: -0.0833em;"></span><span
            class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>
    with <span class="math math-inline"><span class="katex"><span class="katex-mathml">j−1j - 1</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                   style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>
    unique songs.</p>
<p>In this scenario, how many new songs do we have available to choose from?</p>
<p>At this point, we have <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">j−1j - 1</span><span class="katex-html" aria-hidden="true"><span class="base"><span
        class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord mathnormal"
                                                                                       style="margin-right: 0.05724em;">j</span><span
        class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace"
                                                                                               style="margin-right: 0.2222em;"></span></span><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">1</span></span></span></span></span> unique songs in the playlist. Since there are <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">nn</span><span class="katex-html"
                                                                                               aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>
    unique songs in total, the number of new songs we can add to the playlist is <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">n−(j−1)=n−j+1n - (j - 1) = n - j + 1</span><span class="katex-html"
                                                                                                      aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span
            class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
            class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">)</span><span class="mspace"
                                                                    style="margin-right: 0.2778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span
            class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                   style="margin-right: 0.2222em;"></span><span
            class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>.
</p>
<p>Since we have <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">n−j+1n - j + 1</span><span class="katex-html" aria-hidden="true"><span class="base"><span
        class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">n</span><span
        class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace"
                                                                                               style="margin-right: 0.2222em;"></span></span><span
        class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                               style="margin-right: 0.2222em;"></span><span
        class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span> choices
    of the new song, the number of new playlists we can create by adding a new song is <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">dp[i−1][j−1]⋅(n−j+1)\text{dp}[i - 1][j - 1] \cdot (n - j + 1)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
            class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal"
                                                                                                style="margin-right: 0.05724em;">j</span><span
            class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">]</span><span class="mspace"
                                                                    style="margin-right: 0.2222em;"></span><span
            class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace"
                                                                              style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                   style="margin-right: 0.2222em;"></span><span
            class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">)</span></span></span></span></span>. Hence, we add this to <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
            class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span></span></span></span></span>.
</p>
<p>If we replay an old song, the playlist length increases by <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">11</span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                                           style="height: 0.6444em;"></span><span
        class="mord">1</span></span></span></span></span> (from <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">i−1i - 1</span><span class="katex-html" aria-hidden="true"><span class="base"><span
        class="strut" style="height: 0.7429em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">i</span><span
        class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace"
                                                                                               style="margin-right: 0.2222em;"></span></span><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">1</span></span></span></span></span> to <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">ii</span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                                           style="height: 0.6595em;"></span><span
        class="mord mathnormal">i</span></span></span></span></span>), but the number of unique songs remains the same
    (still <span class="math math-inline"><span class="katex"><span class="katex-mathml">jj</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span>). Therefore,
    the number of playlists of length <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">ii</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.6595em;"></span><span
            class="mord mathnormal">i</span></span></span></span></span> with <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">jj</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> unique songs
    can be increased by replaying an old song in every playlist of length <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">i−1i - 1</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.7429em; vertical-align: -0.0833em;"></span><span
            class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>
    with <span class="math math-inline"><span class="katex"><span class="katex-mathml">jj</span><span class="katex-html"
                                                                                                      aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> unique songs.
</p>
<p>In this scenario, how many previously played songs can we choose from?</p>
<p>At this point, we have <span class="math math-inline"><span class="katex"><span class="katex-mathml">jj</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 0.854em; vertical-align: -0.1944em;"></span><span
        class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> unique songs in
    the playlist, so we can choose any of these <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">jj</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord mathnormal"
                                                                                           style="margin-right: 0.05724em;">j</span></span></span></span></span>
    songs. However, due to the constraint that we can't replay a song unless <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">kk</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.03148em;">k</span></span></span></span></span>
    other songs have been played, we can't choose from the last <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">kk</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                 style="margin-right: 0.03148em;">k</span></span></span></span></span>
    played songs.</p>
<p>So, if <span class="math math-inline"><span class="katex"><span class="katex-mathml">j&gt;kj &gt; k</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 0.854em; vertical-align: -0.1944em;"></span><span
        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                               style="margin-right: 0.2778em;"></span><span
        class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span
        class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                style="margin-right: 0.03148em;">k</span></span></span></span></span>,
    the number of old songs we can replay is <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">j−kj - k</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span class="mord mathnormal"
                                                                                           style="margin-right: 0.05724em;">j</span><span
            class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.03148em;">k</span></span></span></span></span>.
</p>
<p>Since we have <span class="math math-inline"><span class="katex"><span class="katex-mathml">j−kj - k</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 0.854em; vertical-align: -0.1944em;"></span><span
        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                               style="margin-right: 0.2222em;"></span><span
        class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                             style="margin-right: 0.03148em;">k</span></span></span></span></span>
    choices of the old song to replay, the number of new playlists we can create by replaying an old song is <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">dp[i−1][j]⋅(j−k)dp[i - 1][j] \cdot (j - k)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mopen">[</span><span
            class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal"
                                                                                                style="margin-right: 0.05724em;">j</span><span
            class="mclose">]</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
            class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span></span></span></span></span>.
    Hence, if <span class="math math-inline"><span class="katex"><span class="katex-mathml">j&gt;kj &gt; k</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                   style="margin-right: 0.2778em;"></span><span
            class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.03148em;">k</span></span></span></span></span>,
    we add this to <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
            class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span></span></span></span></span>.
</p>
<p>These two scenarios encompass all possible transitions for our dynamic programming solution. Each iteration of our
    loop considers both of these possibilities and updates <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
            class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span></span></span></span></span>
    accordingly. Since this problem involves large numbers, we perform all operations modulo <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">109+710^9 + 7</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.8974em; vertical-align: -0.0833em;"></span><span
            class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span
            class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span
            style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span
            class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace"
                                                                                               style="margin-right: 0.2222em;"></span><span
            class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">7</span></span></span></span></span>
    to avoid overflow issues.</p>
<p>In the end, <span class="math math-inline"><span class="katex"><span class="katex-mathml">dp[goal][n]\text{dp}[\text{goal}][n]</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span class="mord text"><span
        class="mord">goal</span></span><span class="mclose">]</span><span class="mopen">[</span><span
        class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span></span> will represent the
    number of possible playlists of length <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">goal\text{goal}</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span
            class="mord text"><span class="mord">goal</span></span></span></span></span></span> using exactly <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">nn</span><span class="katex-html"
                                                                                                   aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.4306em;"></span><span
            class="mord mathnormal">n</span></span></span></span></span> unique songs, which is the answer to our
    problem.</p>
<h4 id="algorithm">Algorithm</h4>
<ol>
    <li>Initialize a two-dimensional dynamic programming table, <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">dp[goal+1][n+1]\text{dp}[\text{goal} + 1][n + 1]</span><span class="katex-html"
                                                                                              aria-hidden="true"><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
            class="mord text"><span class="mord">goal</span></span><span class="mspace"
                                                                         style="margin-right: 0.2222em;"></span><span
            class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span
            class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">]</span></span></span></span></span>, with zeros.
    </li>
    <li>Set <span class="math math-inline"><span class="katex"><span class="katex-mathml">dp[0][0]\text{dp}[0][0]</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span class="mord">0</span><span
            class="mclose">]</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span></span></span></span></span>
        to 1, as there is exactly one way to have a playlist of length <span class="math math-inline"><span
                class="katex"><span class="katex-mathml">00</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.6444em;"></span><span
                class="mord">0</span></span></span></span></span> with <span class="math math-inline"><span
                class="katex"><span class="katex-mathml">00</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.6444em;"></span><span
                class="mord">0</span></span></span></span></span> unique songs.
    </li>
    <li>Iterate <span class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6595em;"></span><span
            class="mord mathnormal">i</span></span></span></span></span> from <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">11</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>
        to <span class="math math-inline"><span class="katex"><span class="katex-mathml">goal\text{goal}</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.8889em; vertical-align: -0.1944em;"></span><span
                class="mord text"><span class="mord">goal</span></span></span></span></span></span>. (This represents
        the current length of the playlist).
        <ul>
            <li>Within this loop, iterate <span class="math math-inline"><span class="katex"><span class="katex-mathml">jj</span><span
                    class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                   style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                    class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> from
                <span class="math math-inline"><span class="katex"><span class="katex-mathml">11</span><span
                        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                       style="height: 0.6444em;"></span><span
                        class="mord">1</span></span></span></span></span> to <span class="math math-inline"><span
                        class="katex"><span class="katex-mathml">min⁡(i,n)\min(i, n)</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
                        class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                        class="mop">min</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span
                        class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span
                        class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>. (This
                represents the number of unique songs in the playlist).
                <ul>
                    <li>Calculate the number of new playlists created by adding a new song: <span
                            class="math math-inline"><span class="katex"><span class="katex-mathml">dp[i−1][j−1]⋅(n−j+1)\text{dp}[i - 1][j - 1] \cdot (n - j + 1)</span><span
                            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
                            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
                            class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                                                       style="margin-right: 0.2222em;"></span></span><span class="base"><span
                            class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                            class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span
                            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                                                       style="margin-right: 0.2222em;"></span></span><span class="base"><span
                            class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                            class="mord">1</span><span class="mclose">]</span><span class="mspace"
                                                                                    style="margin-right: 0.2222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                                                       style="margin-right: 0.2222em;"></span></span><span class="base"><span
                            class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                            class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace"
                                                                                              style="margin-right: 0.2222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                                                       style="margin-right: 0.2222em;"></span></span><span class="base"><span
                            class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                                                       style="margin-right: 0.2222em;"></span></span><span class="base"><span
                            class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                            class="mord">1</span><span class="mclose">)</span></span></span></span></span>. Add this
                        value to <span class="math math-inline"><span class="katex"><span class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span
                                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                               style="height: 1em; vertical-align: -0.25em;"></span><span
                                class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
                                class="mord mathnormal">i</span><span class="mclose">]</span><span
                                class="mopen">[</span><span class="mord mathnormal"
                                                            style="margin-right: 0.05724em;">j</span><span
                                class="mclose">]</span></span></span></span></span> under modulo <span
                                class="math math-inline"><span class="katex"><span
                                class="katex-mathml">109+710^9 + 7</span><span class="katex-html"
                                                                               aria-hidden="true"><span
                                class="base"><span class="strut"
                                                   style="height: 0.8974em; vertical-align: -0.0833em;"></span><span
                                class="mord">1</span><span class="mord"><span class="mord">0</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                                                  style="height: 0.8141em;"><span
                                style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut"
                                                                                   style="height: 2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span
                                class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
                                class="strut" style="height: 0.6444em;"></span><span class="mord">7</span></span></span></span></span>.
                    </li>
                    <li>If <span class="math math-inline"><span class="katex"><span
                            class="katex-mathml">j&gt;kj &gt; k</span><span class="katex-html" aria-hidden="true"><span
                            class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                                   style="margin-right: 0.2778em;"></span><span
                            class="mrel">&gt;</span><span class="mspace"
                                                          style="margin-right: 0.2778em;"></span></span><span
                            class="base"><span class="strut" style="height: 0.6944em;"></span><span
                            class="mord mathnormal"
                            style="margin-right: 0.03148em;">k</span></span></span></span></span>, calculate the number
                        of new playlists created by replaying an old song: <span class="math math-inline"><span
                                class="katex"><span class="katex-mathml">dp[i−1][j]⋅(j−k)\text{dp}[i - 1][j] \cdot (j - k)</span><span
                                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                               style="height: 1em; vertical-align: -0.25em;"></span><span
                                class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
                                class="mord mathnormal">i</span><span class="mspace"
                                                                      style="margin-right: 0.2222em;"></span><span
                                class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
                                class="base"><span class="strut"
                                                   style="height: 1em; vertical-align: -0.25em;"></span><span
                                class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span
                                class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
                                class="mclose">]</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
                                class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
                                class="base"><span class="strut"
                                                   style="height: 1em; vertical-align: -0.25em;"></span><span
                                class="mopen">(</span><span class="mord mathnormal"
                                                            style="margin-right: 0.05724em;">j</span><span
                                class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
                                class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                                class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span
                                class="mclose">)</span></span></span></span></span>. Add this value to <span
                                class="math math-inline"><span class="katex"><span class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span
                                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                               style="height: 1em; vertical-align: -0.25em;"></span><span
                                class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
                                class="mord mathnormal">i</span><span class="mclose">]</span><span
                                class="mopen">[</span><span class="mord mathnormal"
                                                            style="margin-right: 0.05724em;">j</span><span
                                class="mclose">]</span></span></span></span></span> under modulo <span
                                class="math math-inline"><span class="katex"><span
                                class="katex-mathml">109+710^9 + 7</span><span class="katex-html"
                                                                               aria-hidden="true"><span
                                class="base"><span class="strut"
                                                   style="height: 0.8974em; vertical-align: -0.0833em;"></span><span
                                class="mord">1</span><span class="mord"><span class="mord">0</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                                                  style="height: 0.8141em;"><span
                                style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut"
                                                                                   style="height: 2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span
                                class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
                                class="strut" style="height: 0.6444em;"></span><span class="mord">7</span></span></span></span></span>.
                    </li>
                </ul>
            </li>
        </ul>
    </li>
    <li>Return the value of <span class="math math-inline"><span class="katex"><span class="katex-mathml">dp[goal][n]\text{dp}[\text{goal}][n]</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
            class="mord text"><span class="mord">goal</span></span><span class="mclose">]</span><span
            class="mopen">[</span><span class="mord mathnormal">n</span><span
            class="mclose">]</span></span></span></span></span>.
    </li>
</ol>
<h4 id="implementation">Implementation</h4>
<pre>
    Java
    <code>
        class Solution {
    public int numMusicPlaylists(int n, int goal, int k) {
        int MOD = 1_000_000_007;

        // Initialize the DP table
        long[][] dp = new long[goal + 1][n + 1];
        dp[0][0] = 1;

        for (int i = 1; i <= goal; i++) {
            for (int j = 1; j <= Math.min(i, n); j++) {
                // The i-th song is a new song
                dp[i][j] = dp[i - 1][j - 1] * (n - j + 1) % MOD;
                // The i-th song is a song we have played before
                if (j > k) {
                    dp[i][j] = (dp[i][j] + dp[i - 1][j] * (j - k)) % MOD;
                }
            }
        }

        return (int) dp[goal][n];
    }

}
    </code>
    C++
    <code>
        class Solution {
public:
    int numMusicPlaylists(int n, int goal, int k) {
        const int MOD = 1e9 + 7;

        // Initialize the DP table
        vector<vector<long>> dp(goal + 1, vector<long>(n + 1, 0));
        dp[0][0] = 1;

        for (int i = 1; i <= goal; i++) {
            for (int j = 1; j <= min(i, n); j++) {
                // The i-th song is a new song
                dp[i][j] = dp[i - 1][j - 1] * (n - j + 1) % MOD;
                // The i-th song is a song we have played before
                if (j > k) {
                    dp[i][j] = (dp[i][j] + dp[i - 1][j] * (j - k)) % MOD;
                }
            }
        }

        return dp[goal][n];
    }
};
    </code>
    Python3
    <code>
        class Solution:
    def numMusicPlaylists(self, n: int, goal: int, k: int) -> int:
        MOD = 10**9 + 7

        # Initialize the DP table
        dp = [[0 for _ in range(n + 1)] for _ in range(goal + 1)]
        dp[0][0] = 1

        for i in range(1, goal + 1):
            for j in range(1, min(i, n) + 1):
                # The i-th song is a new song
                dp[i][j] = dp[i - 1][j - 1] * (n - j + 1) % MOD
                # The i-th song is a song we have played before
                if j > k:
                    dp[i][j] = (dp[i][j] + dp[i - 1][j] * (j - k)) % MOD

        return dp[goal][n]
    </code>
</pre>
<h4 id="complexity-analysis">Complexity Analysis</h4>
<ul>
    <li>Time Complexity: <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(goal⋅n)O(\text{goal} \cdot n)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span
            class="mord text"><span class="mord">goal</span></span><span class="mspace"
                                                                         style="margin-right: 0.2222em;"></span><span
            class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>.
    </li>
</ul>
<p>We need to iterate over a two-dimensional DP table of size <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">goal+1\text{goal} + 1</span><span class="katex-html" aria-hidden="true"><span class="base"><span
        class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord text"><span
        class="mord">goal</span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span> by <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">n+1n + 1</span><span class="katex-html"
                                                                                                     aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span
        class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>. In each
    cell, we perform constant time operations.</p>
<ul>
    <li>Space Complexity: <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(goal⋅n)O(\text{goal} \cdot n)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span
            class="mord text"><span class="mord">goal</span></span><span class="mspace"
                                                                         style="margin-right: 0.2222em;"></span><span
            class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>.
    </li>
</ul>
<p>We're maintaining a two-dimensional DP table of size <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">goal+1\text{goal} + 1</span><span class="katex-html" aria-hidden="true"><span class="base"><span
        class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord text"><span
        class="mord">goal</span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span> by <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">n+1n + 1</span><span class="katex-html"
                                                                                                     aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span
        class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span> to store
    intermediate results.</p>
<hr>
<h3 id="approach-2-top-down-dynamic-programming-memoization">Approach 2: Top-down Dynamic Programming (Memoization)</h3>
<h4 id="intuition-1">Intuition</h4>
<p>The bottom-up DP solution iteratively builds up to the solution starting from the simplest subproblems. The top-down
    dynamic programming approach, also known as memoization, starts with the original problem and breaks it down into
    subproblems as needed. Here's how we can adjust the solution to a top-down approach.</p>
<p>We declare the same two-dimensional DP table, <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">dp[goal+1][n+1]\text{dp}[\text{goal} + 1][n + 1]</span><span class="katex-html"
                                                                                          aria-hidden="true"><span
        class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span class="mord text"><span
        class="mord">goal</span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span
        class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace"
                                                                                                       style="margin-right: 0.2222em;"></span><span
        class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span
        class="mclose">]</span></span></span></span></span>. This table will keep track of the number of possible
    playlists of length <span class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6595em;"></span><span
            class="mord mathnormal">i</span></span></span></span></span> using <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">jj</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> unique songs.
    All elements in the DP table are initialized to a sentinel value, for example, <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">−1-1</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span
            class="mord">−</span><span class="mord">1</span></span></span></span></span>, which indicates that the
    subproblem hasn't been solved yet.</p>
<blockquote>
    <p>The term "sentinel value" is a common term used in computer science to refer to a special value that's used for a
        specific purpose. In the context of this problem, the sentinel value is a special value that we use to
        initialize the dynamic programming table, and it indicates that a specific subproblem has not been solved
        yet.</p>
</blockquote>
<p>We then define a function, <span class="math math-inline"><span class="katex"><span class="katex-mathml">numberOfPlaylists(i,j)\text{numberOfPlaylists}(i, j)</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord text"><span class="mord">numberOfPlaylists</span></span><span class="mopen">(</span><span
        class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace"
                                                                           style="margin-right: 0.1667em;"></span><span
        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
        class="mclose">)</span></span></span></span></span>, that computes and returns the number of playlists of length
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6595em;"></span><span
            class="mord mathnormal">i</span></span></span></span></span> using <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">jj</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> unique songs.
    Inside this function, we first check if the solution to this subproblem has already been computed by verifying
    whether <span class="math math-inline"><span class="katex"><span class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
            class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span></span></span></span></span>
    is not equal to <span class="math math-inline"><span class="katex"><span class="katex-mathml">−1-1</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.7278em; vertical-align: -0.0833em;"></span><span
            class="mord">−</span><span class="mord">1</span></span></span></span></span>. If it is not, we return <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
            class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mclose">]</span></span></span></span></span>
    because it means we've already solved this subproblem and computed its solution.</p>
<p>If <span class="math math-inline"><span class="katex"><span class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
        class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
        class="mclose">]</span></span></span></span></span> is equal to <span class="math math-inline"><span
        class="katex"><span class="katex-mathml">−1-1</span><span class="katex-html" aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">−</span><span
        class="mord">1</span></span></span></span></span>, then we need to compute the solution.</p>
<p>The base cases of the recursion are as follows:</p>
<ul>
    <li>If both <span class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6595em;"></span><span
            class="mord mathnormal">i</span></span></span></span></span> and <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">jj</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> are equal to
        <span class="math math-inline"><span class="katex"><span class="katex-mathml">00</span><span class="katex-html"
                                                                                                     aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.6444em;"></span><span
                class="mord">0</span></span></span></span></span>, then the number of possible playlists is <span
                class="math math-inline"><span class="katex"><span class="katex-mathml">11</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.6444em;"></span><span
                class="mord">1</span></span></span></span></span>. This case represents the fact that there's exactly
        one way to create a playlist of <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">00</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span></span>
        length with <span class="math math-inline"><span class="katex"><span class="katex-mathml">00</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.6444em;"></span><span
                class="mord">0</span></span></span></span></span> unique songs: an empty playlist.
    </li>
    <li>If <span class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6595em;"></span><span
            class="mord mathnormal">i</span></span></span></span></span> or <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">jj</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> is <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">00</span><span class="katex-html"
                                                                                                   aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span></span>
        and <span class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.6595em;"></span><span
                class="mord mathnormal">i</span></span></span></span></span> is not equal to <span
                class="math math-inline"><span class="katex"><span class="katex-mathml">jj</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span>, then the
        number of possible playlists is <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">00</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span></span>.
        This case represents the impossibility of having a playlist of length <span class="math math-inline"><span
                class="katex"><span class="katex-mathml">ii</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span>
        with <span class="math math-inline"><span class="katex"><span class="katex-mathml">jj</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> unique
        songs. We can directly return <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">00</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span></span>
        in this case.
    </li>
</ul>
<p>In the function <span class="math math-inline"><span class="katex"><span class="katex-mathml">numberOfPlaylists(i,j)\text{numberOfPlaylists}(i, j)</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord text"><span class="mord">numberOfPlaylists</span></span><span class="mopen">(</span><span
        class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace"
                                                                           style="margin-right: 0.1667em;"></span><span
        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
        class="mclose">)</span></span></span></span></span>, these base cases are checked before we proceed to the
    computation part.</p>
<p>Then we calculate the number of possible playlists by considering two cases: adding a new song or replaying an old
    song. The number of ways to add a new song is <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">dp[i−1][j−1]⋅(n−j+1)\text{dp}[i - 1][j - 1] \cdot (n - j + 1)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
            class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal"
                                                                                                style="margin-right: 0.05724em;">j</span><span
            class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">]</span><span class="mspace"
                                                                    style="margin-right: 0.2222em;"></span><span
            class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace"
                                                                              style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                   style="margin-right: 0.2222em;"></span><span
            class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">)</span></span></span></span></span> and to replay an old song is
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">dp[i−1][j]⋅(j−k)\text{dp}[i - 1][j] \cdot (j - k)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
            class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal"
                                                                                                style="margin-right: 0.05724em;">j</span><span
            class="mclose">]</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
            class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span></span></span></span></span>
    if <span class="math math-inline"><span class="katex"><span class="katex-mathml">j&gt;kj &gt; k</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.854em; vertical-align: -0.1944em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                   style="margin-right: 0.2778em;"></span><span
            class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.03148em;">k</span></span></span></span></span>.
</p>
<p>After computing the solution for the subproblem, we store it in <span class="math math-inline"><span
        class="katex"><span class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span class="katex-html"
                                                                                     aria-hidden="true"><span
        class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
        class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
        class="mclose">]</span></span></span></span></span> and return this value. This ensures that if we encounter the
    same subproblem later, we can retrieve the solution from the DP table without needing to re-compute it, which gives
    us the efficiency advantage of dynamic programming.</p>
<p>The final answer to the problem is obtained by calling the function <span class="math math-inline"><span
        class="katex"><span
        class="katex-mathml">numberOfPlaylists(goal,n)\text{numberOfPlaylists}(\text{goal}, n)</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord text"><span class="mord">numberOfPlaylists</span></span><span class="mopen">(</span><span
        class="mord text"><span class="mord">goal</span></span><span class="mpunct">,</span><span class="mspace"
                                                                                                  style="margin-right: 0.1667em;"></span><span
        class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>. This gives us the
    number of possible playlists of length <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">goal\text{goal}</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span
            class="mord text"><span class="mord">goal</span></span></span></span></span></span> using exactly <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">nn</span><span class="katex-html"
                                                                                                   aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.4306em;"></span><span
            class="mord mathnormal">n</span></span></span></span></span> unique songs.</p>
<h4 id="algorithm-1">Algorithm</h4>
<ol>
    <li>Initialize a two-dimensional dynamic programming table, <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">dp[goal+1][n+1]\text{dp}[\text{goal} + 1][n + 1]</span><span class="katex-html"
                                                                                              aria-hidden="true"><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
            class="mord text"><span class="mord">goal</span></span><span class="mspace"
                                                                         style="margin-right: 0.2222em;"></span><span
            class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span
            class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">]</span></span></span></span></span>, with <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">−1-1</span><span class="katex-html"
                                                                                                     aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span
            class="mord">−</span><span class="mord">1</span></span></span></span></span>. This table will be used to
        store the number of possible playlists of length <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">ii</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 0.6595em;"></span><span
                class="mord mathnormal">i</span></span></span></span></span> using exactly <span
                class="math math-inline"><span class="katex"><span class="katex-mathml">jj</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> unique
        songs.
    </li>
    <li>Implement a recursive function, <span class="math math-inline"><span class="katex"><span class="katex-mathml">numberOfPlaylists(i,j)\text{numberOfPlaylists}(i, j)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">numberOfPlaylists</span></span><span class="mopen">(</span><span
            class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace"
                                                                               style="margin-right: 0.1667em;"></span><span
            class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mclose">)</span></span></span></span></span>,
        to calculate the number of playlists of length <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">ii</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 0.6595em;"></span><span
                class="mord mathnormal">i</span></span></span></span></span> with <span class="math math-inline"><span
                class="katex"><span class="katex-mathml">jj</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> unique
        songs.
        <ul>
            <li>If <span class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span
                    class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                   style="height: 0.6595em;"></span><span
                    class="mord mathnormal">i</span></span></span></span></span> is equal to <span
                    class="math math-inline"><span class="katex"><span class="katex-mathml">00</span><span
                    class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                   style="height: 0.6444em;"></span><span
                    class="mord">0</span></span></span></span></span> and <span class="math math-inline"><span
                    class="katex"><span class="katex-mathml">jj</span><span class="katex-html" aria-hidden="true"><span
                    class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                    class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> is
                equal to <span class="math math-inline"><span class="katex"><span class="katex-mathml">00</span><span
                        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                       style="height: 0.6444em;"></span><span
                        class="mord">0</span></span></span></span></span>, return <span class="math math-inline"><span
                        class="katex"><span class="katex-mathml">11</span><span class="katex-html"
                                                                                aria-hidden="true"><span
                        class="base"><span class="strut" style="height: 0.6444em;"></span><span
                        class="mord">1</span></span></span></span></span>. This represents an empty playlist with no
                unique songs.
            </li>
            <li>If either <span class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span
                    class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                   style="height: 0.6595em;"></span><span
                    class="mord mathnormal">i</span></span></span></span></span> or <span class="math math-inline"><span
                    class="katex"><span class="katex-mathml">jj</span><span class="katex-html" aria-hidden="true"><span
                    class="base"><span class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                    class="mord mathnormal" style="margin-right: 0.05724em;">j</span></span></span></span></span> is
                equal to <span class="math math-inline"><span class="katex"><span class="katex-mathml">00</span><span
                        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                       style="height: 0.6444em;"></span><span
                        class="mord">0</span></span></span></span></span>, return <span class="math math-inline"><span
                        class="katex"><span class="katex-mathml">00</span><span class="katex-html"
                                                                                aria-hidden="true"><span
                        class="base"><span class="strut" style="height: 0.6444em;"></span><span
                        class="mord">0</span></span></span></span></span>. This represents an impossible scenario where
                the length of the playlist or the number of unique songs is zero.
            </li>
            <li>If <span class="math math-inline"><span class="katex"><span
                    class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span class="katex-html" aria-hidden="true"><span
                    class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                    class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
                    class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
                    class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
                    class="mclose">]</span></span></span></span></span> is not equal to <span
                    class="math math-inline"><span class="katex"><span class="katex-mathml">−1-1</span><span
                    class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                   style="height: 0.7278em; vertical-align: -0.0833em;"></span><span
                    class="mord">−</span><span class="mord">1</span></span></span></span></span>, return <span
                    class="math math-inline"><span class="katex"><span
                    class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span class="katex-html" aria-hidden="true"><span
                    class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                    class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
                    class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
                    class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
                    class="mclose">]</span></span></span></span></span>. This indicates that the solution for this
                subproblem has already been computed and can be directly retrieved from the dynamic programming table.
            </li>
            <li>Calculate the number of new playlists created by adding a new song to the playlist. This can be done by
                recursively calling <span class="math math-inline"><span class="katex"><span class="katex-mathml">numberOfPlaylists(i−1,j−1)\text{numberOfPlaylists}(i - 1, j - 1)</span><span
                        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
                        class="mord text"><span class="mord">numberOfPlaylists</span></span><span class="mopen">(</span><span
                        class="mord mathnormal">i</span><span class="mspace"
                                                              style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span
                        class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
                        class="strut" style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                        class="mord">1</span><span class="mpunct">,</span><span class="mspace"
                                                                                style="margin-right: 0.1667em;"></span><span
                        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                               style="margin-right: 0.2222em;"></span><span
                        class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
                        class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                        class="mord">1</span><span class="mclose">)</span></span></span></span></span> and multiplying
                it by <span class="math math-inline"><span class="katex"><span
                        class="katex-mathml">(n−j+1)(n - j + 1)</span><span class="katex-html" aria-hidden="true"><span
                        class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                        class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace"
                                                                                          style="margin-right: 0.2222em;"></span><span
                        class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
                        class="base"><span class="strut"
                                           style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                               style="margin-right: 0.2222em;"></span><span
                        class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
                        class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                        class="mord">1</span><span class="mclose">)</span></span></span></span></span>, which represents
                the number of new songs available to choose from. Assign <span class="math math-inline"><span
                        class="katex"><span class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span class="katex-html"
                                                                                                     aria-hidden="true"><span
                        class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                        class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
                        class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
                        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
                        class="mclose">]</span></span></span></span></span> to this value.
            </li>
            <li>Calculate the number of new playlists created by replaying an old song. This can be done by recursively
                calling <span class="math math-inline"><span class="katex"><span class="katex-mathml">numberOfPlaylists(i−1,j)\text{numberOfPlaylists}(i - 1, j)</span><span
                        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
                        class="mord text"><span class="mord">numberOfPlaylists</span></span><span class="mopen">(</span><span
                        class="mord mathnormal">i</span><span class="mspace"
                                                              style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span
                        class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
                        class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                        class="mord">1</span><span class="mpunct">,</span><span class="mspace"
                                                                                style="margin-right: 0.1667em;"></span><span
                        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
                        class="mclose">)</span></span></span></span></span> and multiplying it by <span
                        class="math math-inline"><span class="katex"><span class="katex-mathml">(j−k)(j - k)</span><span
                        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
                        class="mopen">(</span><span class="mord mathnormal"
                                                    style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span><span
                        class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
                        class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                        class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span
                        class="mclose">)</span></span></span></span></span> if <span class="math math-inline"><span
                        class="katex"><span class="katex-mathml">j&gt;kj &gt; k</span><span class="katex-html"
                                                                                            aria-hidden="true"><span
                        class="base"><span class="strut"
                                           style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                               style="margin-right: 0.2778em;"></span><span
                        class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span
                        class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                                style="margin-right: 0.03148em;">k</span></span></span></span></span>.
                This accounts for the restriction that a song can only be replayed if <span
                        class="math math-inline"><span class="katex"><span class="katex-mathml">kk</span><span
                        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                       style="height: 0.6944em;"></span><span
                        class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span>
                other songs have been played before it. If <span class="math math-inline"><span class="katex"><span
                        class="katex-mathml">j&gt;kj &gt; k</span><span class="katex-html" aria-hidden="true"><span
                        class="base"><span class="strut"
                                           style="height: 0.854em; vertical-align: -0.1944em;"></span><span
                        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span class="mspace"
                                                                                               style="margin-right: 0.2778em;"></span><span
                        class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span
                        class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                                style="margin-right: 0.03148em;">k</span></span></span></span></span>,
                add this value to <span class="math math-inline"><span class="katex"><span class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span
                        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
                        class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
                        class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
                        class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
                        class="mclose">]</span></span></span></span></span>.
            </li>
            <li>Return <span class="math math-inline"><span class="katex"><span class="katex-mathml">dp[i][j]\text{dp}[i][j]</span><span
                    class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                   style="height: 1em; vertical-align: -0.25em;"></span><span
                    class="mord text"><span class="mord">dp</span></span><span class="mopen">[</span><span
                    class="mord mathnormal">i</span><span class="mclose">]</span><span class="mopen">[</span><span
                    class="mord mathnormal" style="margin-right: 0.05724em;">j</span><span
                    class="mclose">]</span></span></span></span></span>.
            </li>
        </ul>
    </li>
    <li>Finally, call the <span class="math math-inline"><span class="katex"><span class="katex-mathml">numberOfPlaylists(goal,n)\text{numberOfPlaylists}(\text{goal}, n)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">numberOfPlaylists</span></span><span class="mopen">(</span><span
            class="mord text"><span class="mord">goal</span></span><span class="mpunct">,</span><span class="mspace"
                                                                                                      style="margin-right: 0.1667em;"></span><span
            class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span> function to obtain
        the total number of possible playlists of length <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">goal\text{goal}</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span
                class="mord text"><span class="mord">goal</span></span></span></span></span></span> using exactly <span
                class="math math-inline"><span class="katex"><span class="katex-mathml">nn</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.4306em;"></span><span
                class="mord mathnormal">n</span></span></span></span></span> unique songs. This will be the final answer
        to the problem.
    </li>
</ol>
<h4 id="implementation-1">Implementation</h4>
<pre>
    Java
    <code>
        public class Solution {
    private final int MOD = 1_000_000_007;
    private Long[][] dp;

    public int numMusicPlaylists(int n, int goal, int k) {
        dp = new Long[goal + 1][n + 1];
        for(Long[] row : dp) {
            Arrays.fill(row, -1L);
        }
        return (int) (numberOfPlaylists(goal, n, k, n));
    }

    private long numberOfPlaylists(int i, int j, int k, int n) {
        // Base cases
        if (i == 0 && j == 0) {
            return 1;
        }
        if (i == 0 || j == 0) {
            return 0;
        }
        if (dp[i][j] != -1) {
            return dp[i][j];
        }
        // DP transition: add a new song or replay an old one
        dp[i][j] = (numberOfPlaylists(i - 1, j - 1, k, n) * (n - j + 1)) % MOD;
        if (j > k) {
            dp[i][j] += (numberOfPlaylists(i - 1, j, k, n) * (j - k)) % MOD;
            dp[i][j] %= MOD;
        }
        return dp[i][j];
    }
}
    </code>
    C++
    <code>
        class Solution {
public:
    int numMusicPlaylists(int n, int goal, int k) {
        const int MOD = 1e9 + 7;
        vector dp(goal + 1, vector<long>(n + 1, -1));

        function<long(int, int)> numberOfPlaylists = [&](int i, int j) -> long {
            // Base cases
            if (i == 0 && j == 0) {
                return 1LL;
            }
            if (i == 0 || j == 0) {
                return 0LL;
            }
            if (dp[i][j] != -1) {
                return dp[i][j];
            }
            // DP transition: add a new song or replay an old one
            dp[i][j] = (numberOfPlaylists(i - 1, j - 1) * (n - j + 1)) % MOD;
            if (j > k) {
                dp[i][j] += (numberOfPlaylists(i - 1, j) * (j - k)) % MOD;
                dp[i][j] %= MOD;
            }
            return dp[i][j];
        };

        return numberOfPlaylists(goal, n);
    }
};
    </code>
    Python3
    <code>
        class Solution:
    def numMusicPlaylists(self, n: int, goal: int, k: int) -> int:
        MOD = 1_000_000_007
        dp = [[-1 for _ in range(n + 1)] for _ in range(goal + 1)]

        def number_of_playlists(i, j):
            # Base cases
            if i == 0 and j == 0:
                return 1
            if i == 0 or j == 0:
                return 0
            if dp[i][j] != -1:
                return dp[i][j]
            # DP transition: add a new song or replay an old one
            dp[i][j] = (number_of_playlists(i - 1, j - 1) * (n - j + 1)) % MOD
            if j > k:
                dp[i][j] += (number_of_playlists(i - 1, j) * (j - k)) % MOD
                dp[i][j] %= MOD
            return dp[i][j]

        return number_of_playlists(goal, n)
    </code>
</pre>
<h4 id="complexity-analysis-1">Complexity Analysis</h4>
<ul>
    <li>Time Complexity: <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(goal⋅n)O(\text{goal} \cdot n)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span
            class="mord text"><span class="mord">goal</span></span><span class="mspace"
                                                                         style="margin-right: 0.2222em;"></span><span
            class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>.
    </li>
</ul>
<p>We are filling up a 2D DP table with <span class="math math-inline"><span class="katex"><span class="katex-mathml">goal+1\text{goal}+1</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 0.8889em; vertical-align: -0.1944em;"></span><span
        class="mord text"><span class="mord">goal</span></span><span class="mspace"
                                                                     style="margin-right: 0.2222em;"></span><span
        class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span> rows and
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">n+1n+1</span><span class="katex-html"
                                                                                                     aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span
            class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>
    columns. Each cell of the DP table gets filled once.</p>
<ul>
    <li>Space Complexity: <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(goal⋅n)O(\text{goal} \cdot n)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span
            class="mord text"><span class="mord">goal</span></span><span class="mspace"
                                                                         style="margin-right: 0.2222em;"></span><span
            class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>.
    </li>
</ul>
<p>The 2D DP table uses <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(goal⋅n)O(\text{goal} \cdot n)</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span
        class="mord text"><span class="mord">goal</span></span><span class="mspace"
                                                                     style="margin-right: 0.2222em;"></span><span
        class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">n</span><span
        class="mclose">)</span></span></span></span></span> of memory.</p>
<hr>
<h4 id="approach-3-combinatorics">Approach 3: Combinatorics</h4>
<h4 id="intuition-2">Intuition</h4>
<blockquote>
    <p>Note: this approach is very mathematical and out of scope for an interview. Do not be discouraged if you cannot
        come up with this solution. We have included it for the sake of completeness.</p>
</blockquote>
<p>Imagine you have a set of <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">ii</span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                                           style="height: 0.6595em;"></span><span
        class="mord mathnormal">i</span></span></span></span></span> unique songs, and <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span class="katex-html"
                                                                                               aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span>
    could be any number from <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">kk</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                 style="margin-right: 0.03148em;">k</span></span></span></span></span>
    to <span class="math math-inline"><span class="katex"><span class="katex-mathml">nn</span><span class="katex-html"
                                                                                                    aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.4306em;"></span><span
            class="mord mathnormal">n</span></span></span></span></span> (inclusive).</p>
<p>Now, define <span class="math math-inline"><span class="katex"><span class="katex-mathml">f(i)f(i)</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
        class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></span> as the total number of
    different playlists of length <span class="math math-inline"><span class="katex"><span class="katex-mathml">goal\text{goal}</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.8889em; vertical-align: -0.1944em;"></span><span
            class="mord text"><span class="mord">goal</span></span></span></span></span></span> you can create using
    only songs from this collection (including the playlists that contain fewer than <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span class="katex-html"
                                                                                                   aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6595em;"></span><span
            class="mord mathnormal">i</span></span></span></span></span> unique songs). The important thing to remember
    is that we're following a rule about repeating songs: you can only play the same song again after <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">kk</span><span class="katex-html"
                                                                                                   aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.03148em;">k</span></span></span></span></span>
    other different songs have been played.</p>
<p>How do we count <span class="math math-inline"><span class="katex"><span class="katex-mathml">f(i)f(i)</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
        class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></span>?</p>
<ul>
    <li>For the very first song in the playlist, you have <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">ii</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.6595em;"></span><span
            class="mord mathnormal">i</span></span></span></span></span> choices because you have <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span class="katex-html"
                                                                                                   aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6595em;"></span><span
            class="mord mathnormal">i</span></span></span></span></span> unique songs. So, you pick one song out of
        <span class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span class="katex-html"
                                                                                                     aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span>
        possibilities.
    </li>
    <li>For the second song, since it cannot be the same as the first one, you have <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">i−1i - 1</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.7429em; vertical-align: -0.0833em;"></span><span
            class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>
        choices. You've already played one song, and you can't repeat it yet, so you have one fewer choice.
    </li>
    <li>You keep picking new songs for the first <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">kk</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                 style="margin-right: 0.03148em;">k</span></span></span></span></span>
        songs in the playlist. For the third song, you have <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">i−2i - 2</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 0.7429em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">i</span><span
                class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace"
                                                                                                       style="margin-right: 0.2222em;"></span></span><span
                class="base"><span class="strut" style="height: 0.6444em;"></span><span
                class="mord">2</span></span></span></span></span> choices, for the fourth one <span
                class="math math-inline"><span class="katex"><span class="katex-mathml">i−3i - 3</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.7429em; vertical-align: -0.0833em;"></span><span
                class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
                class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
                class="base"><span class="strut" style="height: 0.6444em;"></span><span
                class="mord">3</span></span></span></span></span> choices, and so on, until the <span
                class="math math-inline"><span class="katex"><span class="katex-mathml">kk</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.6944em;"></span><span
                class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span>-th song,
        for which you have <span class="math math-inline"><span class="katex"><span class="katex-mathml">i−(k−1)i - (k - 1)</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.7429em; vertical-align: -0.0833em;"></span><span
                class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
                class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
                class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span
                class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace"
                                                                                                       style="margin-right: 0.2222em;"></span></span><span
                class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                class="mord">1</span><span class="mclose">)</span></span></span></span></span> choices.
    </li>
    <li>Now, for the <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">(k+1)(k+1)</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span
            class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace"
                                                                                   style="margin-right: 0.2222em;"></span><span
            class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">)</span></span></span></span></span>-th song and onwards, the only
        banned songs are <span class="math math-inline"><span class="katex"><span class="katex-mathml">kk</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.6944em;"></span><span
                class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> last
        played songs. Thus, each of the remaining <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">goal−k\text{goal} - k</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span
                class="mord text"><span class="mord">goal</span></span><span class="mspace"
                                                                             style="margin-right: 0.2222em;"></span><span
                class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
                class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                        style="margin-right: 0.03148em;">k</span></span></span></span></span>
        songs has <span class="math math-inline"><span class="katex"><span class="katex-mathml">i−ki - k</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.7429em; vertical-align: -0.0833em;"></span><span
                class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
                class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
                class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                        style="margin-right: 0.03148em;">k</span></span></span></span></span>
        possible choices.
    </li>
</ul>
<p>This leads us to the formula for <span class="math math-inline"><span class="katex"><span class="katex-mathml">f(i)f(i)</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
        class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></span>: <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">f(i)=i⋅(i−1)⋅(i−2)⋅⋯⋅(i−k+1)⋅(i−k)goal−k=i!(i−k)!(i−k)goal−k.f(i) = i \cdot (i - 1) \cdot (i - 2) \cdot \dots \cdot (i - k + 1) \cdot (i - k)^{\text{goal} - k} = \dfrac{i!}{(i - k)!} (i - k)^{\text{goal} - k}.</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
        class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace"
                                                                           style="margin-right: 0.2778em;"></span><span
        class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span
        class="strut" style="height: 0.6595em;"></span><span class="mord mathnormal">i</span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span><span
        class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span
        class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span
        class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span
        class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">2</span><span
        class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 0.4445em;"></span><span class="minner">⋯</span><span class="mspace"
                                                                                          style="margin-right: 0.2222em;"></span><span
        class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span
        class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 0.7778em; vertical-align: -0.0833em;"></span><span class="mord mathnormal"
                                                                                        style="margin-right: 0.03148em;">k</span><span
        class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace"
                                                                                               style="margin-right: 0.2222em;"></span></span><span
        class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord">1</span><span class="mclose">)</span><span class="mspace"
                                                                style="margin-right: 0.2222em;"></span><span
        class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span
        class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1.0991em; vertical-align: -0.25em;"></span><span class="mord mathnormal"
                                                                                      style="margin-right: 0.03148em;">k</span><span
        class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span
        class="vlist-r"><span class="vlist" style="height: 0.8491em;"><span
        style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span
        class="mord mtight">goal</span></span><span class="mbin mtight">−</span><span class="mord mathnormal mtight"
                                                                                      style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span></span><span
        class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace"
                                                                                               style="margin-right: 0.2778em;"></span></span><span
        class="base"><span class="strut" style="height: 2.3074em; vertical-align: -0.936em;"></span><span
        class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
        class="vlist-r"><span class="vlist" style="height: 1.3714em;"><span style="top: -2.314em;"><span class="pstrut"
                                                                                                         style="height: 3em;"></span><span
        class="mord"><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mspace"
                                                                                             style="margin-right: 0.2222em;"></span><span
        class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal"
                                                                                               style="margin-right: 0.03148em;">k</span><span
        class="mclose">)!</span></span></span><span style="top: -3.23em;"><span class="pstrut"
                                                                                style="height: 3em;"></span><span
        class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.677em;"><span
        class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">i</span><span
        class="mclose">!</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
        class="vlist" style="height: 0.936em;"><span></span></span></span></span></span><span
        class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span
        class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1.0991em; vertical-align: -0.25em;"></span><span class="mord mathnormal"
                                                                                      style="margin-right: 0.03148em;">k</span><span
        class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span
        class="vlist-r"><span class="vlist" style="height: 0.8491em;"><span
        style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span
        class="mord mtight">goal</span></span><span class="mbin mtight">−</span><span class="mord mathnormal mtight"
                                                                                      style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span></span><span
        class="mord">.</span></span></span></span></span></p>
<p>You might think that <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">f(n)f(n)</span><span class="katex-html" aria-hidden="true"><span class="base"><span
        class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal"
                                                                                 style="margin-right: 0.10764em;">f</span><span
        class="mopen">(</span><span class="mord mathnormal">n</span><span
        class="mclose">)</span></span></span></span></span> is the answer to the problem. However it is not the case,
    because <span class="math math-inline"><span class="katex"><span class="katex-mathml">f(n)f(n)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
            class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span> counts also the
    playlists that contain fewer than <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">nn</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.4306em;"></span><span
            class="mord mathnormal">n</span></span></span></span></span> unique songs, which are not valid according to
    the problem statement. We only want the playlists that contain <strong>exactly</strong> <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">nn</span><span class="katex-html"
                                                                                                   aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.4306em;"></span><span
            class="mord mathnormal">n</span></span></span></span></span> unique songs.</p>
<p>Consider an example with <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">n=4n = 4</span><span class="katex-html" aria-hidden="true"><span class="base"><span
        class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace"
                                                                                                   style="margin-right: 0.2778em;"></span><span
        class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span
        class="strut" style="height: 0.6444em;"></span><span class="mord">4</span></span></span></span></span>, <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">k=2k = 2</span><span class="katex-html"
                                                                                                     aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                style="margin-right: 0.03148em;">k</span><span
        class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace"
                                                                                               style="margin-right: 0.2778em;"></span></span><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">2</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">goal\text{goal}</span><span class="katex-html" aria-hidden="true"><span class="base"><span
        class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord text"><span
        class="mord">goal</span></span></span></span></span></span> being an arbitrary number such that <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">goal≥n\text{goal} \ge n</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 0.8889em; vertical-align: -0.1944em;"></span><span
        class="mord text"><span class="mord">goal</span></span><span class="mspace"
                                                                     style="margin-right: 0.2778em;"></span><span
        class="mrel">≥</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span
        class="strut" style="height: 0.4306em;"></span><span
        class="mord mathnormal">n</span></span></span></span></span>. We have <span class="math math-inline"><span
        class="katex"><span class="katex-mathml">44</span><span class="katex-html" aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">4</span></span></span></span></span> songs, let's label them <span class="math math-inline"><span
        class="katex"><span class="katex-mathml">AA</span><span class="katex-html" aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span>,
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">BB</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.05017em;">B</span></span></span></span></span>,
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">CC</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.07153em;">C</span></span></span></span></span>
    and <span class="math math-inline"><span class="katex"><span class="katex-mathml">DD</span><span class="katex-html"
                                                                                                     aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.02778em;">D</span></span></span></span></span>.
</p>
<ul>
    <li>There is <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">(44)=1\binom{4}{4} = 1</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 1.2451em; vertical-align: -0.35em;"></span><span
            class="mord"><span class="mopen delimcenter" style="top: 0em;"><span
            class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
            class="vlist-r"><span class="vlist" style="height: 0.8951em;"><span style="top: -2.355em;"><span
            class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
            class="mord mtight"><span class="mord mtight">4</span></span></span></span><span
            style="top: -3.144em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span
            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                                       style="height: 0.345em;"><span></span></span></span></span></span><span
            class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
            class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace"
                                                                                                   style="margin-right: 0.2778em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>
        set of songs of size <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">44</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 0.6444em;"></span><span class="mord">4</span></span></span></span></span>:
        <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">{A,B,C,D}\{A, B, C, D\}</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                class="mopen">{</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span
                class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                            style="margin-right: 0.05017em;">B</span><span
                class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span
                class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span class="mpunct">,</span><span
                class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                            style="margin-right: 0.02778em;">D</span><span
                class="mclose">}</span></span></span></span></span>. Here <span class="math math-inline"><span
                class="katex"><span
                class="katex-mathml">(ni)=n!i!(n−i)!\binom{n}{i} = \frac{n!}{i! (n - i)!}</span><span class="katex-html"
                                                                                                      aria-hidden="true"><span
                class="base"><span class="strut" style="height: 1.2em; vertical-align: -0.35em;"></span><span
                class="mord"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span
                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                                                         style="height: 0.7454em;"><span
                style="top: -2.355em;"><span class="pstrut" style="height: 2.7em;"></span><span
                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                class="mord mathnormal mtight">i</span></span></span></span><span style="top: -3.144em;"><span
                class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span
                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                                           style="height: 0.345em;"><span></span></span></span></span></span><span
                class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
                class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace"
                                                                                                       style="margin-right: 0.2778em;"></span></span><span
                class="base"><span class="strut" style="height: 1.4001em; vertical-align: -0.52em;"></span><span
                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8801em;"><span
                style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span
                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                class="mord mathnormal mtight">i</span><span class="mclose mtight">!</span><span
                class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span
                class="mbin mtight">−</span><span class="mord mathnormal mtight">i</span><span
                class="mclose mtight">)!</span></span></span></span><span style="top: -3.23em;"><span class="pstrut"
                                                                                                      style="height: 3em;"></span><span
                class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.394em;"><span
                class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span
                class="mord mtight"><span class="mord mathnormal mtight">n</span><span
                class="mclose mtight">!</span></span></span></span></span><span class="vlist-s">​</span></span><span
                class="vlist-r"><span class="vlist"
                                      style="height: 0.52em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span></span></span></span></span> denotes the binomial coefficient
        that represents the number of ways to choose <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">ii</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 0.6595em;"></span><span
                class="mord mathnormal">i</span></span></span></span></span> unique songs from <span
                class="math math-inline"><span class="katex"><span class="katex-mathml">nn</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.4306em;"></span><span
                class="mord mathnormal">n</span></span></span></span></span> songs.
    </li>
    <li>Also, there are <span class="math math-inline"><span class="katex"><span class="katex-mathml">(43)=4\binom{4}{3} = 4</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1.2451em; vertical-align: -0.35em;"></span><span
            class="mord"><span class="mopen delimcenter" style="top: 0em;"><span
            class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
            class="vlist-r"><span class="vlist" style="height: 0.8951em;"><span style="top: -2.355em;"><span
            class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
            class="mord mtight"><span class="mord mtight">3</span></span></span></span><span
            style="top: -3.144em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span
            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                                       style="height: 0.345em;"><span></span></span></span></span></span><span
            class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
            class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace"
                                                                                                   style="margin-right: 0.2778em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">4</span></span></span></span></span>
        sets of songs of size <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">33</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 0.6444em;"></span><span class="mord">3</span></span></span></span></span>:
        <span class="math math-inline"><span class="katex"><span class="katex-mathml">{A,B,C}\{A, B, C\}</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 1em; vertical-align: -0.25em;"></span><span
                class="mopen">{</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span
                class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                            style="margin-right: 0.05017em;">B</span><span
                class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span
                class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span
                class="mclose">}</span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">{A,B,D}\{A, B, D\}</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                class="mopen">{</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span
                class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                            style="margin-right: 0.05017em;">B</span><span
                class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span
                class="mord mathnormal" style="margin-right: 0.02778em;">D</span><span
                class="mclose">}</span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">{A,C,D}\{A, C, D\}</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                class="mopen">{</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span
                class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                            style="margin-right: 0.07153em;">C</span><span
                class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span
                class="mord mathnormal" style="margin-right: 0.02778em;">D</span><span
                class="mclose">}</span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">{B,C,D}\{B, C, D\}</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
                class="mopen">{</span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span
                class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span
                class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span class="mpunct">,</span><span
                class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                            style="margin-right: 0.02778em;">D</span><span
                class="mclose">}</span></span></span></span></span>.
    </li>
    <li>Finally, there are six sets of size <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">(42)=6\binom{4}{2} = 6</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 1.2451em; vertical-align: -0.35em;"></span><span
            class="mord"><span class="mopen delimcenter" style="top: 0em;"><span
            class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
            class="vlist-r"><span class="vlist" style="height: 0.8951em;"><span style="top: -2.355em;"><span
            class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
            class="mord mtight"><span class="mord mtight">2</span></span></span></span><span
            style="top: -3.144em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span
            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                                       style="height: 0.345em;"><span></span></span></span></span></span><span
            class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
            class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace"
                                                                                                   style="margin-right: 0.2778em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">6</span></span></span></span></span>:
        <span class="math math-inline"><span class="katex"><span class="katex-mathml">{A,B}\{A, B\}</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 1em; vertical-align: -0.25em;"></span><span
                class="mopen">{</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span
                class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                            style="margin-right: 0.05017em;">B</span><span
                class="mclose">}</span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">{A,C}\{A, C\}</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span
                class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace"
                                                                                   style="margin-right: 0.1667em;"></span><span
                class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span
                class="mclose">}</span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">{A,D}\{A, D\}</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span
                class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace"
                                                                                   style="margin-right: 0.1667em;"></span><span
                class="mord mathnormal" style="margin-right: 0.02778em;">D</span><span
                class="mclose">}</span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">{B,C}\{B, C\}</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span
                class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mpunct">,</span><span
                class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                            style="margin-right: 0.07153em;">C</span><span
                class="mclose">}</span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">{B,D}\{B, D\}</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span
                class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mpunct">,</span><span
                class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                            style="margin-right: 0.02778em;">D</span><span
                class="mclose">}</span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">{C,D}\{C, D\}</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span
                class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span class="mpunct">,</span><span
                class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                            style="margin-right: 0.02778em;">D</span><span
                class="mclose">}</span></span></span></span></span>.<br>
        Here we do not consider sets with fewer than <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">kk</span><span class="katex-html" aria-hidden="true"><span class="base"><span
                class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                     style="margin-right: 0.03148em;">k</span></span></span></span></span>
        songs.
    </li>
</ul>
<p>Since <span class="math math-inline"><span class="katex"><span class="katex-mathml">f(4)f(4)</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord">4</span><span
        class="mclose">)</span></span></span></span></span> includes playlists containing <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">22</span><span class="katex-html"
                                                                                               aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">2</span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">33</span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                                           style="height: 0.6444em;"></span><span
        class="mord">3</span></span></span></span></span>, or <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">44</span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                                           style="height: 0.6444em;"></span><span
        class="mord">4</span></span></span></span></span> unique songs, we have over-counted some of the playlists and
    now need to correct this over-counting.</p>
<p>We can use a principle from combinatorics, the inclusion-exclusion principle, to do this correction. The basic idea
    of this principle is to subtract the over-counted cases from the total to avoid double counting.</p>
<p>Let's see how it applies to our problem.</p>
<ul>
    <li>The case of <span class="math math-inline"><span class="katex"><span class="katex-mathml">33</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6444em;"></span><span
            class="mord">3</span></span></span></span></span> unique songs:
    </li>
</ul>
<p>Consider any subset of <span class="math math-inline"><span class="katex"><span class="katex-mathml">33</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 0.6444em;"></span><span
        class="mord">3</span></span></span></span></span> unique songs. The total number of playlists that can be made
    from these <span class="math math-inline"><span class="katex"><span class="katex-mathml">33</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6444em;"></span><span
            class="mord">3</span></span></span></span></span> songs is <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">f(3)f(3)</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
            class="mord">3</span><span class="mclose">)</span></span></span></span></span>. Now, when we calculated
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">f(4)f(4)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
            class="mord">4</span><span class="mclose">)</span></span></span></span></span>, we included all the possible
    playlists of <span class="math math-inline"><span class="katex"><span class="katex-mathml">44</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6444em;"></span><span
            class="mord">4</span></span></span></span></span> songs, which implicitly also counts the playlists that
    contain only <span class="math math-inline"><span class="katex"><span class="katex-mathml">33</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6444em;"></span><span
            class="mord">3</span></span></span></span></span> of these <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">44</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">4</span></span></span></span></span>
    songs.</p>
<p>For instance, consider songs <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">AA</span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                                           style="height: 0.6833em;"></span><span
        class="mord mathnormal">A</span></span></span></span></span>, <span class="math math-inline"><span
        class="katex"><span class="katex-mathml">BB</span><span class="katex-html" aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                style="margin-right: 0.05017em;">B</span></span></span></span></span>,
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">CC</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.07153em;">C</span></span></span></span></span>,
    and <span class="math math-inline"><span class="katex"><span class="katex-mathml">DD</span><span class="katex-html"
                                                                                                     aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.02778em;">D</span></span></span></span></span>.
    When we look at <span class="math math-inline"><span class="katex"><span class="katex-mathml">f(4)f(4)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
            class="mord">4</span><span class="mclose">)</span></span></span></span></span>, it counts playlists that use
    songs <span class="math math-inline"><span class="katex"><span class="katex-mathml">AA</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6833em;"></span><span
            class="mord mathnormal">A</span></span></span></span></span>, <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">BB</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.05017em;">B</span></span></span></span></span>,
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">CC</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.07153em;">C</span></span></span></span></span>,
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">DD</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.02778em;">D</span></span></span></span></span>
    but also counts playlists that might use only songs <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">AA</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.6833em;"></span><span
            class="mord mathnormal">A</span></span></span></span></span>, <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">BB</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.05017em;">B</span></span></span></span></span>,
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">CC</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.07153em;">C</span></span></span></span></span>
    (or any other combination of <span class="math math-inline"><span class="katex"><span class="katex-mathml">33</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6444em;"></span><span
            class="mord">3</span></span></span></span></span> songs). These latter playlists are also counted in <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">f(3)f(3)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
            class="mord">3</span><span class="mclose">)</span></span></span></span></span>.</p>
<p>We need to correct this over-counting by subtracting <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">f(3)f(3)</span><span class="katex-html" aria-hidden="true"><span class="base"><span
        class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal"
                                                                                 style="margin-right: 0.10764em;">f</span><span
        class="mopen">(</span><span class="mord">3</span><span class="mclose">)</span></span></span></span></span> from
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">f(4)f(4)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
            class="mord">4</span><span class="mclose">)</span></span></span></span></span>. However, since there are
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">44</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">4</span></span></span></span></span>
    possible combinations of <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">33</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.6444em;"></span><span class="mord">3</span></span></span></span></span> songs
    that we could choose from the <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">44</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.6444em;"></span><span class="mord">4</span></span></span></span></span> songs
    (i.e., <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">(43)=4\binom{4}{3} = 4</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 1.2451em; vertical-align: -0.35em;"></span><span
            class="mord"><span class="mopen delimcenter" style="top: 0em;"><span
            class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
            class="vlist-r"><span class="vlist" style="height: 0.8951em;"><span style="top: -2.355em;"><span
            class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
            class="mord mtight"><span class="mord mtight">3</span></span></span></span><span
            style="top: -3.144em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span
            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                                       style="height: 0.345em;"><span></span></span></span></span></span><span
            class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
            class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace"
                                                                                                   style="margin-right: 0.2778em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">4</span></span></span></span></span>),
    we need to subtract <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">4⋅f(3)4 \cdot f(3)</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">4</span><span
            class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
            class="mord">3</span><span class="mclose">)</span></span></span></span></span> from <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">f(4)f(4)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
            class="mord">4</span><span class="mclose">)</span></span></span></span></span>.</p>
<ul>
    <li>The case of <span class="math math-inline"><span class="katex"><span class="katex-mathml">22</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6444em;"></span><span
            class="mord">2</span></span></span></span></span> unique songs:
    </li>
</ul>
<p>Let's consider the subset <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">{A,B}\{A, B\}</span><span class="katex-html" aria-hidden="true"><span class="base"><span
        class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span
        class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace"
                                                                           style="margin-right: 0.1667em;"></span><span
        class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span
        class="mclose">}</span></span></span></span></span> from our total set <span class="math math-inline"><span
        class="katex"><span class="katex-mathml">{A,B,C,D}\{A, B, C, D\}</span><span class="katex-html"
                                                                                     aria-hidden="true"><span
        class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mopen">{</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace"
                                                                                                       style="margin-right: 0.1667em;"></span><span
        class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mpunct">,</span><span
        class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                    style="margin-right: 0.07153em;">C</span><span
        class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                                                 style="margin-right: 0.02778em;">D</span><span
        class="mclose">}</span></span></span></span></span>. With these <span class="math math-inline"><span
        class="katex"><span class="katex-mathml">22</span><span class="katex-html" aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">2</span></span></span></span></span> songs, we can generate <span class="math math-inline"><span
        class="katex"><span class="katex-mathml">f(2)f(2)</span><span class="katex-html" aria-hidden="true"><span
        class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord">2</span><span
        class="mclose">)</span></span></span></span></span> different playlists, following the rule about song
    repetition.</p>
<p>When we computed <span class="math math-inline"><span class="katex"><span class="katex-mathml">f(4)f(4)</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord">4</span><span
        class="mclose">)</span></span></span></span></span>, it included all possible playlists that could be made from
    any or all of the <span class="math math-inline"><span class="katex"><span class="katex-mathml">44</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6444em;"></span><span
            class="mord">4</span></span></span></span></span> songs (<span class="math math-inline"><span class="katex"><span
            class="katex-mathml">AA</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.6833em;"></span><span
            class="mord mathnormal">A</span></span></span></span></span>, <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">BB</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.05017em;">B</span></span></span></span></span>,
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">CC</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.07153em;">C</span></span></span></span></span>,
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">DD</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.02778em;">D</span></span></span></span></span>).
    Hence, the playlists which include only songs <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">AA</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.6833em;"></span><span
            class="mord mathnormal">A</span></span></span></span></span> and <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">BB</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.05017em;">B</span></span></span></span></span>
    were counted in <span class="math math-inline"><span class="katex"><span class="katex-mathml">f(4)f(4)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
            class="mord">4</span><span class="mclose">)</span></span></span></span></span>.</p>
<p>Then, we computed <span class="math math-inline"><span class="katex"><span class="katex-mathml">f(3)f(3)</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord">3</span><span
        class="mclose">)</span></span></span></span></span> for each combination of <span class="math math-inline"><span
        class="katex"><span class="katex-mathml">33</span><span class="katex-html" aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">3</span></span></span></span></span> songs. For instance, for the combination <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">{A,B,C}\{A, B, C\}</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mopen">{</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace"
                                                                                                       style="margin-right: 0.1667em;"></span><span
        class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mpunct">,</span><span
        class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                    style="margin-right: 0.07153em;">C</span><span
        class="mclose">}</span></span></span></span></span>, it also includes playlists that only use <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">AA</span><span class="katex-html"
                                                                                               aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span>
    and <span class="math math-inline"><span class="katex"><span class="katex-mathml">BB</span><span class="katex-html"
                                                                                                     aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.05017em;">B</span></span></span></span></span>,
    and similarly for <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">{A,B,D}\{A, B, D\}</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mopen">{</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span
            class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                        style="margin-right: 0.05017em;">B</span><span
            class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span
            class="mord mathnormal" style="margin-right: 0.02778em;">D</span><span class="mclose">}</span></span></span></span></span>.
    In this way, we are counting the "only <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">22</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span></span>
    songs" playlists in each <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">f(3)f(3)</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal"
                                                                                     style="margin-right: 0.10764em;">f</span><span
            class="mopen">(</span><span class="mord">3</span><span class="mclose">)</span></span></span></span></span>.
</p>
<p>Now, when we corrected <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">f(4)f(4)</span><span class="katex-html" aria-hidden="true"><span class="base"><span
        class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal"
                                                                                 style="margin-right: 0.10764em;">f</span><span
        class="mopen">(</span><span class="mord">4</span><span class="mclose">)</span></span></span></span></span> by
    subtracting <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">4⋅f(3)4 \cdot f(3)</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">4</span><span
            class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
            class="mord">3</span><span class="mclose">)</span></span></span></span></span>, our aim was to remove the
    over-counting of "only <span class="math math-inline"><span class="katex"><span class="katex-mathml">33</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6444em;"></span><span
            class="mord">3</span></span></span></span></span> songs" playlists. However, as a side effect, we also
    subtracted the "only <span class="math math-inline"><span class="katex"><span class="katex-mathml">22</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6444em;"></span><span
            class="mord">2</span></span></span></span></span> songs" playlists twice. For example, we subtracted
    playlists that includes <span class="math math-inline"><span class="katex"><span class="katex-mathml">AA</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6833em;"></span><span
            class="mord mathnormal">A</span></span></span></span></span> and <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">BB</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.05017em;">B</span></span></span></span></span>
    once for <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">{A,B,C}\{A, B, C\}</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mopen">{</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span
            class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                        style="margin-right: 0.05017em;">B</span><span
            class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span
            class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span class="mclose">}</span></span></span></span></span>
    and once for <span class="math math-inline"><span class="katex"><span class="katex-mathml">{A,B,D}\{A, B, D\}</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mopen">{</span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span
            class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal"
                                                                        style="margin-right: 0.05017em;">B</span><span
            class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span
            class="mord mathnormal" style="margin-right: 0.02778em;">D</span><span class="mclose">}</span></span></span></span></span>.
    Hence, we've subtracted the "only <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">22</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span></span>
    songs" playlists two more times than we've added them, leading to under-counting.</p>
<p>So, to correct for this under-counting, we need to add back the number of "only <span class="math math-inline"><span
        class="katex"><span class="katex-mathml">22</span><span class="katex-html" aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">2</span></span></span></span></span> songs" playlists. There are <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">(42)=6\binom{4}{2} = 6</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1.2451em; vertical-align: -0.35em;"></span><span
        class="mord"><span class="mopen delimcenter" style="top: 0em;"><span
        class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
        class="vlist-r"><span class="vlist" style="height: 0.8951em;"><span style="top: -2.355em;"><span class="pstrut"
                                                                                                         style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">2</span></span></span></span><span style="top: -3.144em;"><span class="pstrut"
                                                                                            style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span
        class="vlist-r"><span class="vlist" style="height: 0.345em;"><span></span></span></span></span></span><span
        class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
        class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace"
                                                                                               style="margin-right: 0.2778em;"></span></span><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">6</span></span></span></span></span> ways to choose <span class="math math-inline"><span
        class="katex"><span class="katex-mathml">22</span><span class="katex-html" aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">2</span></span></span></span></span> unique songs from our set of <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">44</span><span class="katex-html"
                                                                                               aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">4</span></span></span></span></span> songs (<span class="math math-inline"><span
        class="katex"><span class="katex-mathml">AA</span><span class="katex-html" aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span>,
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">BB</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.05017em;">B</span></span></span></span></span>,
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">CC</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.07153em;">C</span></span></span></span></span>,
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">DD</span><span class="katex-html"
                                                                                                 aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.02778em;">D</span></span></span></span></span>).
    So, for each of these <span class="math math-inline"><span class="katex"><span class="katex-mathml">22</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6444em;"></span><span
            class="mord">2</span></span></span></span></span> song combinations, we add <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">f(2)f(2)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
            class="mord">2</span><span class="mclose">)</span></span></span></span></span> to our count. This means we
    add <span class="math math-inline"><span class="katex"><span class="katex-mathml">6⋅f(2)6 \cdot f(2)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6444em;"></span><span
            class="mord">6</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span
            class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut"
                                                                                                  style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
            class="mord">2</span><span class="mclose">)</span></span></span></span></span> to our count to correct for
    the under-counting of "only <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">22</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 0.6444em;"></span><span class="mord">2</span></span></span></span></span>
    songs" playlists.</p>
<p>The final answer for <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">n=4n = 4</span><span class="katex-html" aria-hidden="true"><span class="base"><span
        class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace"
                                                                                                   style="margin-right: 0.2778em;"></span><span
        class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span
        class="strut" style="height: 0.6444em;"></span><span class="mord">4</span></span></span></span></span>, <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">k=2k = 2</span><span class="katex-html"
                                                                                                     aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                style="margin-right: 0.03148em;">k</span><span
        class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace"
                                                                                               style="margin-right: 0.2778em;"></span></span><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">2</span></span></span></span></span> is <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">(44)f(4)−(43)f(3)+(42)f(2)\binom{4}{4} f(4) - \binom{4}{3} f(3) + \binom{4}{2} f(2)</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1.2451em; vertical-align: -0.35em;"></span><span
        class="mord"><span class="mopen delimcenter" style="top: 0em;"><span
        class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
        class="vlist-r"><span class="vlist" style="height: 0.8951em;"><span style="top: -2.355em;"><span class="pstrut"
                                                                                                         style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">4</span></span></span></span><span style="top: -3.144em;"><span class="pstrut"
                                                                                            style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span
        class="vlist-r"><span class="vlist" style="height: 0.345em;"><span></span></span></span></span></span><span
        class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord">4</span><span
        class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1.2451em; vertical-align: -0.35em;"></span><span class="mord"><span
        class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span
        class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                                                 style="height: 0.8951em;"><span
        style="top: -2.355em;"><span class="pstrut" style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">3</span></span></span></span><span style="top: -3.144em;"><span class="pstrut"
                                                                                            style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span
        class="vlist-r"><span class="vlist" style="height: 0.345em;"><span></span></span></span></span></span><span
        class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord">3</span><span
        class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1.2451em; vertical-align: -0.35em;"></span><span class="mord"><span
        class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span
        class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                                                 style="height: 0.8951em;"><span
        style="top: -2.355em;"><span class="pstrut" style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">2</span></span></span></span><span style="top: -3.144em;"><span class="pstrut"
                                                                                            style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span
        class="vlist-r"><span class="vlist" style="height: 0.345em;"><span></span></span></span></span></span><span
        class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord">2</span><span
        class="mclose">)</span></span></span></span></span>.</p>
<p>For <span class="math math-inline"><span class="katex"><span class="katex-mathml">n=7n = 7</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 0.4306em;"></span><span
        class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2778em;"></span><span
        class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span
        class="strut" style="height: 0.6444em;"></span><span class="mord">7</span></span></span></span></span>, <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">k=4k = 4</span><span class="katex-html"
                                                                                                     aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                style="margin-right: 0.03148em;">k</span><span
        class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace"
                                                                                               style="margin-right: 0.2778em;"></span></span><span
        class="base"><span class="strut" style="height: 0.6444em;"></span><span
        class="mord">4</span></span></span></span></span> the answer would be <span class="math math-inline"><span
        class="katex"><span class="katex-mathml">(77)f(7)−(76)f(6)+(75)f(5)−(74)f(4)\binom{7}{7} f(7) - \binom{7}{6} f(6) + \binom{7}{5} f(5) - \binom{7}{4} f(4)</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1.2451em; vertical-align: -0.35em;"></span><span
        class="mord"><span class="mopen delimcenter" style="top: 0em;"><span
        class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
        class="vlist-r"><span class="vlist" style="height: 0.8951em;"><span style="top: -2.355em;"><span class="pstrut"
                                                                                                         style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">7</span></span></span></span><span style="top: -3.144em;"><span class="pstrut"
                                                                                            style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span
        class="vlist-r"><span class="vlist" style="height: 0.345em;"><span></span></span></span></span></span><span
        class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord">7</span><span
        class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1.2451em; vertical-align: -0.35em;"></span><span class="mord"><span
        class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span
        class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                                                 style="height: 0.8951em;"><span
        style="top: -2.355em;"><span class="pstrut" style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">6</span></span></span></span><span style="top: -3.144em;"><span class="pstrut"
                                                                                            style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span
        class="vlist-r"><span class="vlist" style="height: 0.345em;"><span></span></span></span></span></span><span
        class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord">6</span><span
        class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1.2451em; vertical-align: -0.35em;"></span><span class="mord"><span
        class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span
        class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                                                 style="height: 0.8951em;"><span
        style="top: -2.355em;"><span class="pstrut" style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">5</span></span></span></span><span style="top: -3.144em;"><span class="pstrut"
                                                                                            style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span
        class="vlist-r"><span class="vlist" style="height: 0.345em;"><span></span></span></span></span></span><span
        class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord">5</span><span
        class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
        class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 1.2451em; vertical-align: -0.35em;"></span><span class="mord"><span
        class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span
        class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                                                 style="height: 0.8951em;"><span
        style="top: -2.355em;"><span class="pstrut" style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">4</span></span></span></span><span style="top: -3.144em;"><span class="pstrut"
                                                                                            style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
        class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span
        class="vlist-r"><span class="vlist" style="height: 0.345em;"><span></span></span></span></span></span><span
        class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
        class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span class="mord">4</span><span
        class="mclose">)</span></span></span></span></span>.</p>
<p>In general, for each <span class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 0.6595em;"></span><span
        class="mord mathnormal">i</span></span></span></span></span> from <span class="math math-inline"><span
        class="katex"><span class="katex-mathml">kk</span><span class="katex-html" aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                style="margin-right: 0.03148em;">k</span></span></span></span></span>
    to <span class="math math-inline"><span class="katex"><span class="katex-mathml">nn</span><span class="katex-html"
                                                                                                    aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.4306em;"></span><span
            class="mord mathnormal">n</span></span></span></span></span>, we calculate <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">(−1)n−i(ni)f(i)(-1)^{n-i} \binom{n}{i} f(i)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1.2em; vertical-align: -0.35em;"></span><span
            class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose"><span
            class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                                                           style="height: 0.8247em;"><span
            style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
            class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span
            class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span><span
            class="mord"><span class="mopen delimcenter" style="top: 0em;"><span
            class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
            class="vlist-r"><span class="vlist" style="height: 0.7454em;"><span style="top: -2.355em;"><span
            class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
            class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span
            style="top: -3.144em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
            class="mord mathnormal mtight">n</span></span></span></span></span><span
            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                                       style="height: 0.345em;"><span></span></span></span></span></span><span
            class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
            class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
            class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></span>. The <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">(−1)n−i(-1)^{n-i}</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1.0747em; vertical-align: -0.25em;"></span><span
            class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose"><span
            class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                                                           style="height: 0.8247em;"><span
            style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
            class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span
            class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></span></span>
    factor alternates the addition and subtraction to correct the over-counting and under-counting.</p>
<p>Finally, the total number of valid playlists that contain exactly <span class="math math-inline"><span class="katex"><span
        class="katex-mathml">nn</span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                                           style="height: 0.4306em;"></span><span
        class="mord mathnormal">n</span></span></span></span></span> unique songs is the sum of these corrected counts:
    <span class="math math-inline"><span class="katex"><span class="katex-mathml">∑i=kn(−1)n−i(ni)f(i)=∑i=kn(−1)n−in!i!(n−i)!i!(i−k)!(i−k)goal−k=n!∑i=kn(−1)n−i(i−k)goal−k(n−i)!(i−k)!\sum_{i=k}^n (-1)^{n - i} \binom{n}{i} f(i) = \sum_{i=k}^n (-1)^{n - i} \frac{n!}{i!(n-i)!} \frac{i!}{(i - k)!} (i - k)^{\text{goal} - k} = n! \sum_{i=k}^n (-1)^{n - i} \frac{(i - k)^{\text{goal} - k}}{(n-i)!(i - k)!}</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1.2em; vertical-align: -0.35em;"></span><span
            class="mop"><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span
            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                                                       style="height: 0.8043em;"><span
            style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut"
                                                                                  style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
            class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span
            class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span
            style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span
            class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span
            class="vlist-r"><span class="vlist"
                                  style="height: 0.2997em;"><span></span></span></span></span></span></span><span
            class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose"><span
            class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                                                           style="height: 0.8247em;"><span
            style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
            class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span
            class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span><span
            class="mord"><span class="mopen delimcenter" style="top: 0em;"><span
            class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
            class="vlist-r"><span class="vlist" style="height: 0.7454em;"><span style="top: -2.355em;"><span
            class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
            class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span
            style="top: -3.144em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
            class="mord mathnormal mtight">n</span></span></span></span></span><span
            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                                       style="height: 0.345em;"><span></span></span></span></span></span><span
            class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span
            class="mord mathnormal" style="margin-right: 0.10764em;">f</span><span class="mopen">(</span><span
            class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace"
                                                                               style="margin-right: 0.2778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span
            class="base"><span class="strut" style="height: 1.4001em; vertical-align: -0.52em;"></span><span
            class="mop"><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span
            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                                                       style="height: 0.8043em;"><span
            style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut"
                                                                                  style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
            class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span
            class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span
            style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span
            class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span
            class="vlist-r"><span class="vlist"
                                  style="height: 0.2997em;"><span></span></span></span></span></span></span><span
            class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose"><span
            class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                                                           style="height: 0.8247em;"><span
            style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
            class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span
            class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span><span
            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.8801em;"><span
            style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
            class="mord mathnormal mtight">i</span><span class="mclose mtight">!</span><span
            class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span
            class="mord mathnormal mtight">i</span><span class="mclose mtight">)!</span></span></span></span><span
            style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line"
                                                                                         style="border-bottom-width: 0.04em;"></span></span><span
            style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
            class="mord mathnormal mtight">n</span><span class="mclose mtight">!</span></span></span></span></span><span
            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                                       style="height: 0.52em;"><span></span></span></span></span></span><span
            class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span
            class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                                                     style="height: 0.8801em;"><span
            style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span
            class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span
            class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span><span
            class="mclose mtight">)!</span></span></span></span><span style="top: -3.23em;"><span class="pstrut"
                                                                                                  style="height: 3em;"></span><span
            class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.394em;"><span
            class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span
            class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mclose mtight">!</span></span></span></span></span><span
            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                                       style="height: 0.52em;"><span></span></span></span></span></span><span
            class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span
            class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1.0991em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose"><span
            class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                                                           style="height: 0.8491em;"><span
            style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span
            class="mord mtight">goal</span></span><span class="mbin mtight">−</span><span class="mord mathnormal mtight"
                                                                                          style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span></span><span
            class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace"
                                                                                                   style="margin-right: 0.2778em;"></span></span><span
            class="base"><span class="strut" style="height: 1.6539em; vertical-align: -0.52em;"></span><span
            class="mord mathnormal">n</span><span class="mclose">!</span><span class="mspace"
                                                                               style="margin-right: 0.1667em;"></span><span
            class="mop"><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span
            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                                                       style="height: 0.8043em;"><span
            style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut"
                                                                                  style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
            class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span
            class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span></span></span></span><span
            style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span
            class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span
            class="vlist-r"><span class="vlist"
                                  style="height: 0.2997em;"><span></span></span></span></span></span></span><span
            class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mclose"><span
            class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                                                           style="height: 0.8247em;"><span
            style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
            class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span
            class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span><span
            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1339em;"><span
            style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span
            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span
            class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span
            class="mord mathnormal mtight">i</span><span class="mclose mtight">)!</span><span
            class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span
            class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span><span
            class="mclose mtight">)!</span></span></span></span><span style="top: -3.23em;"><span class="pstrut"
                                                                                                  style="height: 3em;"></span><span
            class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span style="top: -3.485em;"><span
            class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span
            class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span
            class="mbin mtight">−</span><span class="mord mathnormal mtight"
                                              style="margin-right: 0.03148em;">k</span><span class="mclose mtight"><span
            class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
            class="vlist" style="height: 0.927em;"><span style="top: -2.931em; margin-right: 0.0714em;"><span
            class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span
            class="mord mtight"><span class="mord text mtight"><span class="mord mtight">goal</span></span><span
            class="mbin mtight">−</span><span class="mord mathnormal mtight"
                                              style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></span><span
            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                                       style="height: 0.52em;"><span></span></span></span></span></span><span
            class="mclose nulldelimiter"></span></span></span></span></span></span>.</p>
<p>To calculate each summand quickly, we precalculate factorials and inverse factorials modulo <span
        class="math math-inline"><span class="katex"><span class="katex-mathml">109+710^9 + 7</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 0.8974em; vertical-align: -0.0833em;"></span><span
        class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span
        class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span
        style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span
        class="sizing reset-size6 size3 mtight"><span
        class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace"
                                                                                           style="margin-right: 0.2222em;"></span><span
        class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span
        class="strut" style="height: 0.6444em;"></span><span class="mord">7</span></span></span></span></span> in the
    arrays <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">factorial\text{factorial}</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord text"><span
            class="mord">factorial</span></span></span></span></span></span> and <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">inv_factorial\text{inv\_factorial}</span><span class="katex-html"
                                                                                                    aria-hidden="true"><span
            class="base"><span class="strut" style="height: 1.0044em; vertical-align: -0.31em;"></span><span
            class="mord text"><span class="mord">inv_factorial</span></span></span></span></span></span> respectively.
</p>
<h4 id="algorithm-2">Algorithm</h4>
<ol>
    <li>Initialize the <span class="math math-inline"><span class="katex"><span class="katex-mathml">factorial\text{factorial}</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6944em;"></span><span
            class="mord text"><span class="mord">factorial</span></span></span></span></span></span> and <span
            class="math math-inline"><span class="katex"><span
            class="katex-mathml">inv_factorial\text{inv\_factorial}</span><span class="katex-html"
                                                                                aria-hidden="true"><span
            class="base"><span class="strut" style="height: 1.0044em; vertical-align: -0.31em;"></span><span
            class="mord text"><span class="mord">inv_factorial</span></span></span></span></span></span> arrays to
        precalculate the factorial and inverse factorial values modulo <span class="math math-inline"><span
                class="katex"><span class="katex-mathml">109+710^9 + 7</span><span class="katex-html"
                                                                                   aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.8974em; vertical-align: -0.0833em;"></span><span
                class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span
                class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span
                style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span
                class="sizing reset-size6 size3 mtight"><span
                class="mord mtight">9</span></span></span></span></span></span></span></span><span class="mspace"
                                                                                                   style="margin-right: 0.2222em;"></span><span
                class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
                class="base"><span class="strut" style="height: 0.6444em;"></span><span
                class="mord">7</span></span></span></span></span> up to <span class="math math-inline"><span
                class="katex"><span class="katex-mathml">nn</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>.
    </li>
    <li>Calculate the factorial and inverse factorial values using the formula <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">factorial[i]=factorial[i−1]⋅i\text{factorial}[i] = \text{factorial}[i - 1] \cdot i</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">factorial</span></span><span class="mopen">[</span><span
            class="mord mathnormal">i</span><span class="mclose">]</span><span class="mspace"
                                                                               style="margin-right: 0.2778em;"></span><span
            class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord text"><span class="mord">factorial</span></span><span class="mopen">[</span><span
            class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord">1</span><span class="mclose">]</span><span class="mspace"
                                                                    style="margin-right: 0.2222em;"></span><span
            class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6595em;"></span><span
            class="mord mathnormal">i</span></span></span></span></span> and the <a
            href="https://en.wikipedia.org/wiki/Fermat%27s_little_theorem" target="_blank">Fermat's Little Theorem</a>
        respectively.
    </li>
    <li>Initialize variables <span class="math math-inline"><span class="katex"><span class="katex-mathml">sign\text{sign}</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.8623em; vertical-align: -0.1944em;"></span><span
            class="mord text"><span class="mord">sign</span></span></span></span></span></span> to <span
            class="math math-inline"><span class="katex"><span class="katex-mathml">11</span><span class="katex-html"
                                                                                                   aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>
        and <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">answer\text{answer}</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord text"><span
                class="mord">answer</span></span></span></span></span></span> to <span class="math math-inline"><span
                class="katex"><span class="katex-mathml">00</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.6444em;"></span><span
                class="mord">0</span></span></span></span></span>. These variables will be used to apply the principle
        of inclusion-exclusion.
    </li>
    <li>Iterate <span class="math math-inline"><span class="katex"><span class="katex-mathml">ii</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6595em;"></span><span
            class="mord mathnormal">i</span></span></span></span></span> from <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">nn</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.4306em;"></span><span
            class="mord mathnormal">n</span></span></span></span></span> down to <span class="math math-inline"><span
            class="katex"><span class="katex-mathml">kk</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                    style="margin-right: 0.03148em;">k</span></span></span></span></span>.
        <ul>
            <li>Calculate <span class="math math-inline"><span class="katex"><span
                    class="katex-mathml">temp\text{temp}</span><span class="katex-html" aria-hidden="true"><span
                    class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span
                    class="mord text"><span class="mord">temp</span></span></span></span></span></span> as <span
                    class="math math-inline"><span class="katex"><span class="katex-mathml">(i−k)goal−k(n−i)!(i−k)!\frac{(i - k)^{\text{goal} - k}}{(n-i)!(i - k)!}</span><span
                    class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                   style="height: 1.6539em; vertical-align: -0.52em;"></span><span
                    class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1339em;"><span
                    style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span
                    class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                    class="mopen mtight">(</span><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span
                    class="mord mathnormal mtight">i</span><span class="mclose mtight">)!</span><span
                    class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span
                    class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span><span class="mclose mtight">)!</span></span></span></span><span
                    style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line"
                                                                                                 style="border-bottom-width: 0.04em;"></span></span><span
                    style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span
                    class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                    class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span
                    class="mord mathnormal mtight" style="margin-right: 0.03148em;">k</span><span class="mclose mtight"><span
                    class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span
                    class="vlist-r"><span class="vlist" style="height: 0.927em;"><span
                    style="top: -2.931em; margin-right: 0.0714em;"><span class="pstrut"
                                                                         style="height: 2.5em;"></span><span
                    class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span
                    class="mord text mtight"><span class="mord mtight">goal</span></span><span
                    class="mbin mtight">−</span><span class="mord mathnormal mtight"
                                                      style="margin-right: 0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></span><span
                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                                               style="height: 0.52em;"><span></span></span></span></span></span><span
                    class="mclose nulldelimiter"></span></span></span></span></span></span>, update <span
                    class="math math-inline"><span class="katex"><span
                    class="katex-mathml">answer\text{answer}</span><span class="katex-html" aria-hidden="true"><span
                    class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord text"><span
                    class="mord">answer</span></span></span></span></span></span> as <span
                    class="math math-inline"><span class="katex"><span class="katex-mathml">answer+sign⋅temp\text{answer} + \text{sign} \cdot \text{temp}</span><span
                    class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                   style="height: 0.6667em; vertical-align: -0.0833em;"></span><span
                    class="mord text"><span class="mord">answer</span></span><span class="mspace"
                                                                                   style="margin-right: 0.2222em;"></span><span
                    class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
                    class="base"><span class="strut" style="height: 0.8623em; vertical-align: -0.1944em;"></span><span
                    class="mord text"><span class="mord">sign</span></span><span class="mspace"
                                                                                 style="margin-right: 0.2222em;"></span><span
                    class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
                    class="base"><span class="strut" style="height: 0.8095em; vertical-align: -0.1944em;"></span><span
                    class="mord text"><span class="mord">temp</span></span></span></span></span></span>, and update
                <span class="math math-inline"><span class="katex"><span
                        class="katex-mathml">sign\text{sign}</span><span class="katex-html" aria-hidden="true"><span
                        class="base"><span class="strut"
                                           style="height: 0.8623em; vertical-align: -0.1944em;"></span><span
                        class="mord text"><span class="mord">sign</span></span></span></span></span></span> as <span
                        class="math math-inline"><span class="katex"><span class="katex-mathml">−sign-\text{sign}</span><span
                        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                                       style="height: 0.8623em; vertical-align: -0.1944em;"></span><span
                        class="mord">−</span><span class="mord text"><span class="mord">sign</span></span></span></span></span></span>.
            </li>
        </ul>
    </li>
    <li>Return <span class="math math-inline"><span class="katex"><span class="katex-mathml">n!⋅answern! \cdot \text{answer}</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6944em;"></span><span
            class="mord mathnormal">n</span><span class="mclose">!</span><span class="mspace"
                                                                               style="margin-right: 0.2222em;"></span><span
            class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord text"><span
            class="mord">answer</span></span></span></span></span></span> as the final answer to the problem. This is
        the number of distinct playlists of length <span class="math math-inline"><span class="katex"><span
                class="katex-mathml">goal\text{goal}</span><span class="katex-html" aria-hidden="true"><span
                class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span
                class="mord text"><span class="mord">goal</span></span></span></span></span></span> that can be created
        with <span class="math math-inline"><span class="katex"><span class="katex-mathml">nn</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.4306em;"></span><span
                class="mord mathnormal">n</span></span></span></span></span> unique songs and obeying the <span
                class="math math-inline"><span class="katex"><span class="katex-mathml">kk</span><span
                class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                               style="height: 0.6944em;"></span><span
                class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> distance
        rule.
    </li>
</ol>
<h4 id="implementation-2">Implementation</h4>
<pre>
    Java
    <code>
        public class Solution {
    private static final long MOD = 1_000_000_007;

    // Pre-calculated factorials and inverse factorials
    private long[] factorial;
    private long[] invFactorial;

    // Main method: calculates number of playlists
    public int numMusicPlaylists(int n, int goal, int k) {
        // Pre-calculate factorials and inverse factorials
        precalculateFactorials(n);

        // Initialize variables for calculation
        int sign = 1;
        long answer = 0;

        // Loop from 'n' down to 'k'
        for (int i = n; i >= k; i--) {
            // Calculate temporary result for this iteration
            long temp = power(i - k, goal - k);
            temp = (temp * invFactorial[n - i]) % MOD;
            temp = (temp * invFactorial[i - k]) % MOD;

            // Add or subtract temporary result to/from answer
            answer = (answer + sign * temp + MOD) % MOD;

            // Flip sign for next iteration
            sign *= -1;
        }

        // Final result is n! * answer, all under modulo
        return (int) ((factorial[n] * answer) % MOD);
    }

    // Method to pre-calculate factorials and inverse factorials up to 'n'
    private void precalculateFactorials(int n) {
        factorial = new long[n + 1];
        invFactorial = new long[n + 1];
        factorial[0] = invFactorial[0] = 1;

        // Calculate factorials and inverse factorials for each number up to 'n'
        for (int i = 1; i <= n; i++) {
            factorial[i] = (factorial[i - 1] * i) % MOD;
            // Inverse factorial calculated using Fermat's Little Theorem
            invFactorial[i] = power(factorial[i], (int) (MOD - 2));
        }
    }

    // Method to calculate power of a number under modulo using binary exponentiation
    private long power(long base, int exponent) {
        long result = 1L;

        // Loop until exponent is not zero
        while (exponent > 0) {
            // If exponent is odd, multiply result with base
            if ((exponent & 1) == 1) {
                result = (result * base) % MOD;
            }
            // Divide the exponent by 2 and square the base
            exponent >>= 1;
            base = (base * base) % MOD;
        }

        return result;
    }
}
    </code>
    C++
    <code>
        #include <vector>

class Solution {
private:
    static const long long MOD = 1e9 + 7;
    vector<long long> factorial;
    vector<long long> invFactorial;

    // Function to calculate power under modulo MOD
    long long power(long long base, int exponent) {
        long long result = 1;
        // Loop until exponent is not zero
        while (exponent > 0) {
            // If exponent is odd, multiply result with base
            if (exponent & 1) {
                result = (result * base) % MOD;
            }
            // Divide the exponent by 2 and square the base
            exponent >>= 1;
            base = (base * base) % MOD;
        }
        return result;
    }

    // Function to pre-calculate factorials and inverse factorials
    void precalculateFactorials(int n) {
        factorial.resize(n + 1);
        invFactorial.resize(n + 1);
        factorial[0] = invFactorial[0] = 1;
        // Calculate factorials and inverse factorials for each number up to 'n'
        for (int i = 1; i <= n; i++) {
            factorial[i] = (factorial[i - 1] * i) % MOD;
            // Inverse factorial calculated using Fermat's Little Theorem
            invFactorial[i] = power(factorial[i], MOD - 2);
        }
    }

public:
    int numMusicPlaylists(int n, int goal, int k) {
        // Pre-calculate factorials and inverse factorials
        precalculateFactorials(n);
        // Initialize variables for calculation
        int sign = 1;
        long long answer = 0;
        // Loop from 'n' down to 'k'
        for (int i = n; i >= k; i--) {
            // Calculate temporary result for this iteration
            long long temp = power(i - k, goal - k);
            temp = (temp * invFactorial[n - i]) % MOD;
            temp = (temp * invFactorial[i - k]) % MOD;
            // Add or subtract temporary result to/from answer
            answer = (answer + sign * temp + MOD) % MOD;
            // Flip sign for next iteration
            sign *= -1;
        }
        // Final result is n! * answer, all under modulo
        return (factorial[n] * answer) % MOD;
    }
};
    </code>
    Python3
    <code>
        class Solution:
    MOD = 1_000_000_007

    def power(self, base, exponent):
        result = 1
        # Loop until exponent is not zero
        while exponent > 0:
            # If exponent is odd, multiply result with base
            if exponent & 1:
                result = (result * base) % self.MOD
            # Divide the exponent by 2 and square the base
            exponent >>= 1
            base = (base * base) % self.MOD
        return result

    def precalculate_factorials(self, n):
        self.factorial = [1] * (n + 1)
        self.inv_factorial = [1] * (n + 1)
        # Calculate factorials and inverse factorials for each number up to 'n'
        for i in range(1, n + 1):
            self.factorial[i] = (self.factorial[i - 1] * i) % self.MOD
            # Inverse factorial calculated using Fermat's Little Theorem
            self.inv_factorial[i] = self.power(self.factorial[i], self.MOD - 2)

    def numMusicPlaylists(self, n, goal, k):
        # Pre-calculate factorials and inverse factorials
        self.precalculate_factorials(n)
        # Initialize variables for calculation
        sign = 1
        answer = 0
        # Loop from 'n' down to 'k'
        for i in range(n, k - 1, -1):
            # Calculate temporary result for this iteration
            temp = self.power(i - k, goal - k)
            temp = (temp * self.inv_factorial[n - i]) % self.MOD
            temp = (temp * self.inv_factorial[i - k]) % self.MOD
            # Add or subtract temporary result to/from answer
            answer = (answer + sign * temp + self.MOD) % self.MOD
            # Flip sign for next iteration
            sign *= -1
        # Final result is n! * answer, all under modulo
        return (self.factorial[n] * answer) % self.MOD
    </code>
</pre>
<h4 id="complexity-analysis-2">Complexity Analysis</h4>
<ul>
    <li>Time Complexity: <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(nlog⁡goal)O(n \log \text{goal})</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span
            class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.1667em;"></span><span
            class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace"
                                                                                      style="margin-right: 0.1667em;"></span><span
            class="mord text"><span class="mord">goal</span></span><span
            class="mclose">)</span></span></span></span></span>.
    </li>
</ul>
<p>The main loop runs from <span class="math math-inline"><span class="katex"><span class="katex-mathml">nn</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 0.4306em;"></span><span
        class="mord mathnormal">n</span></span></span></span></span> down to <span class="math math-inline"><span
        class="katex"><span class="katex-mathml">kk</span><span class="katex-html" aria-hidden="true"><span
        class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal"
                                                                                style="margin-right: 0.03148em;">k</span></span></span></span></span>,
    so it iterates <span class="math math-inline"><span class="katex"><span class="katex-mathml">n−k+1=O(n)n - k + 1 = O(n)</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 0.6667em; vertical-align: -0.0833em;"></span><span
            class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.0833em;"></span><span
            class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace"
                                                                                   style="margin-right: 0.2222em;"></span><span
            class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span><span
            class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace"
                                                                                                   style="margin-right: 0.2778em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span
            class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span> times.<br>
    Inside the main loop, we calculate the power of <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">(i−k)(i - k)</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span
            class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span></span></span></span></span>
    raised to <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">(goal−k)(\text{goal} - k)</span><span class="katex-html" aria-hidden="true"><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mopen">(</span><span class="mord text"><span class="mord">goal</span></span><span class="mspace"
                                                                                                     style="margin-right: 0.2222em;"></span><span
            class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span
            class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span></span></span></span></span>,
    which takes <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(log⁡goal)O(\log \text{goal})</span><span
            class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                           style="height: 1em; vertical-align: -0.25em;"></span><span
            class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span
            class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace"
                                                                                      style="margin-right: 0.1667em;"></span><span
            class="mord text"><span class="mord">goal</span></span><span
            class="mclose">)</span></span></span></span></span> time.</p>
<p>So the total time complexity is <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(nlog⁡goal)O(n \log \text{goal})</span><span
        class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                                                       style="height: 1em; vertical-align: -0.25em;"></span><span
        class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span
        class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop">lo<span
        style="margin-right: 0.01389em;">g</span></span><span class="mspace"
                                                              style="margin-right: 0.1667em;"></span><span
        class="mord text"><span class="mord">goal</span></span><span class="mclose">)</span></span></span></span></span>.
</p>
<ul>
    <li>Space Complexity: <span class="math math-inline"><span class="katex"><span
            class="katex-mathml">O(n)O(n)</span><span class="katex-html" aria-hidden="true"><span class="base"><span
            class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal"
                                                                                     style="margin-right: 0.02778em;">O</span><span
            class="mopen">(</span><span class="mord mathnormal">n</span><span
            class="mclose">)</span></span></span></span></span>.
    </li>
</ul>
<p>We maintain arrays for precalculated factorials and inverse factorials.</p>
</body>
</html>